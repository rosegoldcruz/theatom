(()=>{var e={};e.id=931,e.ids=[931],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},85807:e=>{"use strict";e.exports=require("module")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},6162:e=>{"use strict";e.exports=require("worker_threads")},71568:e=>{"use strict";e.exports=require("zlib")},91688:()=>{},194:()=>{},43777:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>d,originalPathname:()=>u,pages:()=>h,routeModule:()=>f,tree:()=>c}),s(94401),s(24542),s(18922);var r=s(48571),i=s(40919),n=s(67995),a=s.n(n),o=s(49004),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,94401)),"C:\\Users\\Administrator\\theatom\\frontend\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,24542)),"C:\\Users\\Administrator\\theatom\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,18922,23)),"next/dist/client/components/not-found-error"]}],h=["C:\\Users\\Administrator\\theatom\\frontend\\app\\page.tsx"],u="/page",d={require:s,loadChunk:()=>Promise.resolve()},f=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},67760:(e,t,s)=>{Promise.resolve().then(s.bind(s,26493))},26493:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>sa});var r,i,n,a,o,l,c,h,u,d,f,p={};s.r(p),s.d(p,{Receiver:()=>P,Sender:()=>C,WebSocket:()=>A,WebSocketServer:()=>$,createWebSocketStream:()=>O,default:()=>I});var g=s(99888),m=s(89671);let y=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=(...e)=>Promise.resolve().then(s.t.bind(s,36619,23)).then(({default:t})=>t(...e)):t=fetch,(...e)=>t(...e)};class b extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class v extends b{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class _ extends b{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class w extends b{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(r||(r={}));class x{constructor(e,{headers:t={},customFetch:s,region:i=r.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=y(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s,r,i,n,a;return r=this,i=void 0,n=void 0,a=function*(){try{let r;let{headers:i,method:n,body:a}=t,o={},{region:l}=t;l||(l=this.region);let c=new URL(`${this.url}/${e}`);l&&"any"!==l&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l)),a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&("undefined"!=typeof Blob&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",r=a):"string"==typeof a?(o["Content-Type"]="text/plain",r=a):"undefined"!=typeof FormData&&a instanceof FormData?r=a:(o["Content-Type"]="application/json",r=JSON.stringify(a)));let h=yield this.fetch(c.toString(),{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:r}).catch(e=>{throw new v(e)}),u=h.headers.get("x-relay-error");if(u&&"true"===u)throw new _(h);if(!h.ok)throw new w(h);let d=(null!==(s=h.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return{data:"application/json"===d?yield h.json():"application/octet-stream"===d?yield h.blob():"text/event-stream"===d?h:"multipart/form-data"===d?yield h.formData():yield h.text(),error:null,response:h}}catch(e){return{data:null,error:e,response:e instanceof w||e instanceof _?e.context:void 0}}},new(n||(n=Promise))(function(e,t){function s(e){try{l(a.next(e))}catch(e){t(e)}}function o(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof n?r:new n(function(e){e(r)})).then(s,o)}l((a=a.apply(r,i||[])).next())})}}let{PostgrestClient:k,PostgrestQueryBuilder:j,PostgrestFilterBuilder:S,PostgrestTransformBuilder:E,PostgrestBuilder:T,PostgrestError:N}=s(16388);var O=s(71767),P=s(64462),C=s(85364),A=s(26086),$=s(43128);let I=A,R=(()=>{try{return function(){if("undefined"!=typeof WebSocket)return WebSocket;if(void 0!==global.WebSocket)return global.WebSocket;if(void 0!==window.WebSocket)return window.WebSocket;if(void 0!==self.WebSocket)return self.WebSocket;throw Error("`WebSocket` is not supported in this environment")}()}catch{if(A)return A;return p}})();(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(i||(i={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(n||(n={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(a||(a={})),(o||(o={})).websocket="websocket",function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(l||(l={}));class L{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):"string"==typeof e?t(JSON.parse(e)):t({})}_binaryDecode(e){let t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){let r=t.getUint8(1),i=t.getUint8(2),n=this.HEADER_LENGTH+2,a=s.decode(e.slice(n,n+r));n+=r;let o=s.decode(e.slice(n,n+i));return n+=i,{ref:null,topic:a,event:o,payload:JSON.parse(s.decode(e.slice(n,e.byteLength)))}}}class U{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(c||(c={}));let B=(e,t,s={})=>{var r;let i=null!==(r=s.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce((s,r)=>(s[r]=D(r,e,t,i),s),{})},D=(e,t,s,r)=>{let i=t.find(t=>t.name===e),n=null==i?void 0:i.type,a=s[e];return n&&!r.includes(n)?M(n,a):q(a)},M=(e,t)=>{if("_"===e.charAt(0))return G(t,e.slice(1,e.length));switch(e){case c.bool:return F(t);case c.float4:case c.float8:case c.int2:case c.int4:case c.int8:case c.numeric:case c.oid:return W(t);case c.json:case c.jsonb:return z(t);case c.timestamp:return H(t);case c.abstime:case c.date:case c.daterange:case c.int4range:case c.int8range:case c.money:case c.reltime:case c.text:case c.time:case c.timestamptz:case c.timetz:case c.tsrange:case c.tstzrange:default:return q(t)}},q=e=>e,F=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},W=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},z=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(`JSON parse error: ${e}`)}return e},G=(e,t)=>{if("string"!=typeof e)return e;let s=e.length-1,r=e[s];if("{"===e[0]&&"}"===r){let r;let i=e.slice(1,s);try{r=JSON.parse("["+i+"]")}catch(e){r=i?i.split(","):[]}return r.map(e=>M(t,e))}return e},H=e=>"string"==typeof e?e.replace(" ","T"):e,V=e=>{let t=e;return(t=(t=t.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")};class K{constructor(e,t,s={},r=1e4){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(h||(h={}));class J{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let s=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},e=>{let{onJoin:t,onLeave:s,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=J.syncState(this.state,e,t,s),this.pendingDiffs.forEach(e=>{this.state=J.syncDiff(this.state,e,t,s)}),this.pendingDiffs=[],r()}),this.channel._on(s.diff,{},e=>{let{onJoin:t,onLeave:s,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=J.syncDiff(this.state,e,t,s),r())}),this.onJoin((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})}),this.onLeave((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){let i=this.cloneDeep(e),n=this.transformState(t),a={},o={};return this.map(i,(e,t)=>{n[e]||(o[e]=t)}),this.map(n,(e,t)=>{let s=i[e];if(s){let r=t.map(e=>e.presence_ref),i=s.map(e=>e.presence_ref),n=t.filter(e=>0>i.indexOf(e.presence_ref)),l=s.filter(e=>0>r.indexOf(e.presence_ref));n.length>0&&(a[e]=n),l.length>0&&(o[e]=l)}else a[e]=t}),this.syncDiff(i,{joins:a,leaves:o},s,r)}static syncDiff(e,t,s,r){let{joins:i,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(t,r)=>{var i;let n=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(r),n.length>0){let s=e[t].map(e=>e.presence_ref),r=n.filter(e=>0>s.indexOf(e.presence_ref));e[t].unshift(...r)}s(t,n,r)}),this.map(n,(t,s)=>{let i=e[t];if(!i)return;let n=s.map(e=>e.presence_ref);i=i.filter(e=>0>n.indexOf(e.presence_ref)),e[t]=i,r(t,i,s),0===i.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,s)=>{let r=e[s];return"metas"in r?t[s]=r.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[s]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(u||(u={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(d||(d={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(f||(f={}));class Z{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=n.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new K(this,a.join,this.params,this.timeout),this.rejoinTimer=new U(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=n.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=n.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=n.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=n.errored,this.rejoinTimer.scheduleTimeout())}),this._on(a.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new J(this),this.broadcastEndpointURL=V(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.state==n.closed){let{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(t=>null==e?void 0:e(f.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(f.CLOSED));let l={},c={broadcast:i,presence:a,postgres_changes:null!==(r=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map(e=>e.filter))&&void 0!==r?r:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var s;if(this.socket.setAuth(),void 0===t){null==e||e(f.SUBSCRIBED);return}{let r=this.bindings.postgres_changes,i=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,a=[];for(let s=0;s<i;s++){let i=r[s],{filter:{event:o,schema:l,table:c,filter:h}}=i,u=t&&t[s];if(u&&u.event===o&&u.schema===l&&u.table===c&&u.filter===h)a.push(Object.assign(Object.assign({},i),{id:u.id}));else{this.unsubscribe(),this.state=n.errored,null==e||e(f.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=a,e&&e(f.SUBSCRIBED);return}}).receive("error",t=>{this.state=n.errored,null==e||e(f.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(f.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,r;if(this._canPush()||"broadcast"!==e.type)return new Promise(s=>{var r,i,n;let a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(n=null===(i=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===i?void 0:i.broadcast)||void 0===n?void 0:n.ack)||s("ok"),a.receive("ok",()=>s("ok")),a.receive("error",()=>s("error")),a.receive("timeout",()=>s("timed out"))});{let{event:i,payload:n}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:n,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await (null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=n.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(a.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{(s=new K(this,a.leave,{},e)).receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{null==s||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,s){let r=new AbortController,i=setTimeout(()=>r.abort(),s),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),n}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new K(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,i;let n=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:h}=a;if(s&&[o,l,c,h].indexOf(n)>=0&&s!==this._joinRef())return;let u=this._onMessage(n,t,s);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter(e=>{var t,s,r;return(null===(t=e.filter)||void 0===t?void 0:t.event)==="*"||(null===(r=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===r?void 0:r.toLocaleLowerCase())===n}).map(e=>e.callback(u,s)):null===(i=this.bindings[n])||void 0===i||i.filter(e=>{var s,r,i,a,o,l;if(!["broadcast","presence","postgres_changes"].includes(n))return e.type.toLocaleLowerCase()===n;if("id"in e){let n=e.id,a=null===(s=e.filter)||void 0===s?void 0:s.event;return n&&(null===(r=t.ids)||void 0===r?void 0:r.includes(n))&&("*"===a||(null==a?void 0:a.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{let s=null===(o=null===(a=null==e?void 0:e.filter)||void 0===a?void 0:a.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===s||s===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof u&&"ids"in u){let e=u.data,{schema:t,table:s,commit_timestamp:r,type:i,errors:n}=e;u=Object.assign(Object.assign({},{schema:t,table:s,commit_timestamp:r,eventType:i,new:{},old:{},errors:n}),this._getPayloadRecords(e))}e.callback(u,s)})}_isClosed(){return this.state===n.closed}_isJoined(){return this.state===n.joined}_isJoining(){return this.state===n.joining}_isLeaving(){return this.state===n.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){let r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){let s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===s&&Z.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(a.close,{},e)}_onError(e){this._on(a.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=n.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=B(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=B(e.columns,e.old_record)),t}}let Y=()=>{},X=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Q{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Y,this.ref=0,this.logger=Y,this.conn=null,this.sendBuffer=[],this.serializer=new L,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=(...e)=>Promise.resolve().then(s.t.bind(s,36619,23)).then(({default:t})=>t(...e)):t=fetch,(...e)=>t(...e)},this.endPoint=`${e}/${o.websocket}`,this.httpEndpoint=V(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),((null==t?void 0:t.logLevel)||(null==t?void 0:t.log_level))&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);let i=null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new U(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=R),!this.transport)throw Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(e=>e.teardown()))}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case i.connecting:return l.Connecting;case i.open:return l.Open;case i.closing:return l.Closing;default:return l.Closed}}isConnected(){return this.connectionState()===l.Open}channel(e,t={config:{}}){let s=`realtime:${e}`,r=this.getChannels().find(e=>e.topic===s);if(r)return r;{let s=new Z(`realtime:${e}`,t,this);return this.channels.push(s),s}}push(e){let{topic:t,event:s,payload:r,ref:i}=e,n=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${s} (${i})`,r),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t,version:"realtime-js/2.11.15"}),e.joinedOnce&&e._isJoined()&&e._push(a.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:s,payload:r,ref:i}=e;"phoenix"===t&&"phx_reply"===s&&this.heartbeatCallback("ok"==e.payload.status?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${s} ${i&&"("+i+")"||""}`,r),Array.from(this.channels).filter(e=>e._isMember(t)).forEach(e=>e._trigger(s,r,i)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(a.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let s=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${s}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([X],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class ee extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function et(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class es extends ee{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class er extends ee{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let ei=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=(...e)=>Promise.resolve().then(s.t.bind(s,36619,23)).then(({default:t})=>t(...e)):t=fetch,(...e)=>t(...e)},en=()=>(function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function o(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(s.t.bind(s,36619,23))).Response:Response}),ea=e=>{if(Array.isArray(e))return e.map(e=>ea(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,s])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=ea(s)}),t};var eo=function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function o(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})};let el=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ec=(e,t,s)=>eo(void 0,void 0,void 0,function*(){e instanceof(yield en())&&!(null==s?void 0:s.noResolveJson)?e.json().then(s=>{t(new es(el(s),e.status||500))}).catch(e=>{t(new er(el(e),e))}):t(new er(el(e),e))}),eh=(e,t,s,r)=>{let i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),s))};function eu(e,t,s,r,i,n){return eo(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(s,eh(t,r,i,n)).then(e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()}).then(e=>a(e)).catch(e=>ec(e,o,r))})})}function ed(e,t,s,r){return eo(this,void 0,void 0,function*(){return eu(e,"GET",t,s,r)})}function ef(e,t,s,r,i){return eo(this,void 0,void 0,function*(){return eu(e,"POST",t,r,i,s)})}function ep(e,t,s,r,i){return eo(this,void 0,void 0,function*(){return eu(e,"DELETE",t,r,i,s)})}var eg=function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function o(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})};let em={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ey={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class eb{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=ei(r)}uploadOrUpdate(e,t,s,r){return eg(this,void 0,void 0,function*(){try{let i;let n=Object.assign(Object.assign({},ey),r),a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(n.upsert)}),o=n.metadata;"undefined"!=typeof Blob&&s instanceof Blob?((i=new FormData).append("cacheControl",n.cacheControl),o&&i.append("metadata",this.encodeMetadata(o)),i.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?((i=s).append("cacheControl",n.cacheControl),o&&i.append("metadata",this.encodeMetadata(o))):(i=s,a["cache-control"]=`max-age=${n.cacheControl}`,a["content-type"]=n.contentType,o&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==r?void 0:r.headers)&&(a=Object.assign(Object.assign({},a),r.headers));let l=this._removeEmptyFolders(t),c=this._getFinalPath(l),h=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:a},(null==n?void 0:n.duplex)?{duplex:n.duplex}:{})),u=yield h.json();if(h.ok)return{data:{path:l,id:u.Id,fullPath:u.Key},error:null};return{data:null,error:u}}catch(e){if(et(e))return{data:null,error:e};throw e}})}upload(e,t,s){return eg(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return eg(this,void 0,void 0,function*(){let i=this._removeEmptyFolders(e),n=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${n}`);a.searchParams.set("token",t);try{let e;let t=Object.assign({upsert:ey.upsert},r),n=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&s instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(e=s).append("cacheControl",t.cacheControl):(e=s,n["cache-control"]=`max-age=${t.cacheControl}`,n["content-type"]=t.contentType);let o=yield this.fetch(a.toString(),{method:"PUT",body:e,headers:n}),l=yield o.json();if(o.ok)return{data:{path:i,fullPath:l.Key},error:null};return{data:null,error:l}}catch(e){if(et(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e,t){return eg(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");let i=yield ef(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),n=new URL(this.url+i.url),a=n.searchParams.get("token");if(!a)throw new ee("No token returned by API");return{data:{signedUrl:n.toString(),path:e,token:a},error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}update(e,t,s){return eg(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return eg(this,void 0,void 0,function*(){try{return{data:yield ef(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}copy(e,t,s){return eg(this,void 0,void 0,function*(){try{return{data:{path:(yield ef(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,s){return eg(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),i=yield ef(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers}),n=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:i={signedUrl:encodeURI(`${this.url}${i.signedURL}${n}`)},error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,s){return eg(this,void 0,void 0,function*(){try{let r=yield ef(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:r.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null})),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}download(e,t){return eg(this,void 0,void 0,function*(){let s=void 0!==(null==t?void 0:t.transform),r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),i=r?`?${r}`:"";try{let t=this._getFinalPath(e),r=yield ed(this.fetch,`${this.url}/${s?"render/image/authenticated":"object"}/${t}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}info(e){return eg(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let e=yield ed(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:ea(e),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}exists(e){return eg(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield function(e,t,s,r){return eo(this,void 0,void 0,function*(){return eu(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),void 0)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(et(e)&&e instanceof er){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}})}getPublicUrl(e,t){let s=this._getFinalPath(e),r=[],i=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&r.push(i);let n=void 0!==(null==t?void 0:t.transform),a=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==a&&r.push(a);let o=r.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${n?"render/image":"object"}/public/${s}${o}`)}}}remove(e){return eg(this,void 0,void 0,function*(){try{return{data:yield ep(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}list(e,t,s){return eg(this,void 0,void 0,function*(){try{let r=Object.assign(Object.assign(Object.assign({},em),t),{prefix:e||""});return{data:yield ef(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}let ev={"X-Client-Info":"storage-js/2.7.1"};var e_=function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function o(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})};class ew{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},ev),t),this.fetch=ei(s)}listBuckets(){return e_(this,void 0,void 0,function*(){try{return{data:yield ed(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}getBucket(e){return e_(this,void 0,void 0,function*(){try{return{data:yield ed(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}createBucket(e,t={public:!1}){return e_(this,void 0,void 0,function*(){try{return{data:yield ef(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return e_(this,void 0,void 0,function*(){try{return{data:yield function(e,t,s,r,i){return eo(this,void 0,void 0,function*(){return eu(e,"PUT",t,r,void 0,s)})}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}emptyBucket(e){return e_(this,void 0,void 0,function*(){try{return{data:yield ef(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}deleteBucket(e){return e_(this,void 0,void 0,function*(){try{return{data:yield ep(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(et(e))return{data:null,error:e};throw e}})}}class ex extends ew{constructor(e,t={},s){super(e,t,s)}from(e){return new eb(this.url,this.headers,e,this.fetch)}}let ek="";"undefined"!=typeof Deno?ek="deno":"undefined"!=typeof document?ek="web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?ek="react-native":ek="node";let ej={headers:{"X-Client-Info":`supabase-js-${ek}/2.51.0`}},eS={schema:"public"},eE={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},eT={};var eN=s(36619),eO=s.n(eN);let eP=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=eO():t=fetch,(...e)=>t(...e)},eC=()=>"undefined"==typeof Headers?eN.Headers:Headers,eA=(e,t,s)=>{let r=eP(s),i=eC();return(s,n)=>(function(e,t,s,r){return new(s||(s=Promise))(function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function o(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){var a;let o=null!==(a=yield t())&&void 0!==a?a:e,l=new i(null==n?void 0:n.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),r(s,Object.assign(Object.assign({},n),{headers:l}))})},e$="2.71.0",eI={"X-Client-Info":`gotrue-js/${e$}`},eR="X-Supabase-Api-Version",eL={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},eU=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class eB extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function eD(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class eM extends eB{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}class eq extends eB{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class eF extends eB{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class eW extends eF{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class ez extends eF{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class eG extends eF{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class eH extends eF{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eV extends eF{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eK extends eF{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function eJ(e){return eD(e)&&"AuthRetryableFetchError"===e.name}class eZ extends eF{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class eY extends eF{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}let eX="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),eQ=" 	\n\r=".split(""),e0=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<eQ.length;t+=1)e[eQ[t].charCodeAt(0)]=-2;for(let t=0;t<eX.length;t+=1)e[eX[t].charCodeAt(0)]=t;return e})();function e1(e,t,s){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;)s(eX[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6;else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;)s(eX[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6}function e2(e,t,s){let r=e0[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else if(-2===r)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}function e4(e){let t=[],s=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},n=e=>{(function(e,t,s){if(0===t.utf8seq){if(e<=127){s(e);return}for(let s=1;s<6;s+=1)if((e>>7-s&1)==0){t.utf8seq=s;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&s(t.codepoint)}})(e,r,s)};for(let t=0;t<e.length;t+=1)e2(e.charCodeAt(t),i,n);return t.join("")}let e8=()=>"undefined"!=typeof window&&"undefined"!=typeof document,e6={tested:!1,writable:!1},e3=()=>{if(!e8())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(e6.tested)return e6.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),e6.tested=!0,e6.writable=!0}catch(e){e6.tested=!0,e6.writable=!1}return e6.writable},e5=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=(...e)=>Promise.resolve().then(s.t.bind(s,36619,23)).then(({default:t})=>t(...e)):t=fetch,(...e)=>t(...e)},e9=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,e7=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},te=async(e,t)=>{let s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(e){return s}},tt=async(e,t)=>{await e.removeItem(t)};class ts{constructor(){this.promise=new ts.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function tr(e){let t=e.split(".");if(3!==t.length)throw new eY("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!eU.test(t[e]))throw new eY("JWT not in base64url format");return{header:JSON.parse(e4(t[0])),payload:JSON.parse(e4(t[1])),signature:function(e){let t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)e2(e.charCodeAt(t),s,r);return new Uint8Array(t)}(t[2]),raw:{header:t[0],payload:t[1]}}}async function ti(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function tn(e){return("0"+e.toString(16)).substr(-2)}async function ta(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function to(e){return"undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder?btoa(await ta(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e)}async function tl(e,t,s=!1){let r=function(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,s="";for(let r=0;r<56;r++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,tn).join("")}(),i=r;s&&(i+="/PASSWORD_RECOVERY"),await e7(e,`${t}-code-verifier`,i);let n=await to(r),a=r===n?"plain":"s256";return[n,a]}ts.promiseConstructor=Promise;let tc=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,th=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tu(e){if(!th.test(e))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function td(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){let e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var tf=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]]);return s};let tp=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),tg=[502,503,504];async function tm(e){var t;let s,r;if(!e9(e))throw new eK(tp(e),0);if(tg.includes(e.status))throw new eK(tp(e),e.status);try{s=await e.json()}catch(e){throw new eq(tp(e),e)}let i=function(e){let t=e.headers.get(eR);if(!t||!t.match(tc))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(i&&i.getTime()>=eL["2024-01-01"].timestamp&&"object"==typeof s&&s&&"string"==typeof s.code?r=s.code:"object"==typeof s&&s&&"string"==typeof s.error_code&&(r=s.error_code),r){if("weak_password"===r)throw new eZ(tp(s),e.status,(null===(t=s.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===r)throw new eW}else if("object"==typeof s&&s&&"object"==typeof s.weak_password&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new eZ(tp(s),e.status,s.weak_password.reasons);throw new eM(tp(s),e.status||500,r)}let ty=(e,t,s,r)=>{let i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),s))};async function tb(e,t,s,r){var i;let n=Object.assign({},null==r?void 0:r.headers);n[eR]||(n[eR]=eL["2024-01-01"].name),(null==r?void 0:r.jwt)&&(n.Authorization=`Bearer ${r.jwt}`);let a=null!==(i=null==r?void 0:r.query)&&void 0!==i?i:{};(null==r?void 0:r.redirectTo)&&(a.redirect_to=r.redirectTo);let o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await tv(e,t,s+o,{headers:n,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function tv(e,t,s,r,i,n){let a;let o=ty(t,r,i,n);try{a=await e(s,Object.assign({},o))}catch(e){throw console.error(e),new eK(tp(e),0)}if(a.ok||await tm(a),null==r?void 0:r.noResolveJson)return a;try{return await a.json()}catch(e){await tm(e)}}function t_(e){var t,s;let r=null;return e.access_token&&e.refresh_token&&e.expires_in&&(r=Object.assign({},e),!e.expires_at)&&(r.expires_at=(s=e.expires_in,Math.round(Date.now()/1e3)+s)),{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function tw(e){let t=t_(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function tx(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function tk(e){return{data:e,error:null}}function tj(e){let{action_link:t,email_otp:s,hashed_token:r,redirect_to:i,verification_type:n}=e;return{data:{properties:{action_link:t,email_otp:s,hashed_token:r,redirect_to:i,verification_type:n},user:Object.assign({},tf(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function tS(e){return e}let tE=["global","local","others"];var tT=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]]);return s};class tN{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=e5(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=tE[0]){if(0>tE.indexOf(t))throw Error(`@supabase/auth-js: Parameter scope must be one of ${tE.join(", ")}`);try{return await tb(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(eD(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await tb(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:tx})}catch(e){if(eD(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,s=tT(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=null==s?void 0:s.newEmail,delete r.newEmail),await tb(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:tj,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(eD(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await tb(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:tx})}catch(e){if(eD(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,s,r,i,n,a,o;try{let l={nextPage:null,lastPage:0,total:0},c=await tb(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(i=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==i?i:""},xform:tS});if(c.error)throw c.error;let h=await c.json(),u=null!==(n=c.headers.get("x-total-count"))&&void 0!==n?n:0,d=null!==(o=null===(a=c.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==o?o:[];return d.length>0&&(d.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);l[`${s}Page`]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},h),l),error:null}}catch(e){if(eD(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){tu(e);try{return await tb(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:tx})}catch(e){if(eD(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){tu(e);try{return await tb(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:tx})}catch(e){if(eD(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){tu(e);try{return await tb(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:tx})}catch(e){if(eD(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){tu(e.userId);try{let{data:t,error:s}=await tb(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(e){if(eD(e))return{data:null,error:e};throw e}}async _deleteFactor(e){tu(e.userId),tu(e.id);try{return{data:await tb(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(eD(e))return{data:null,error:e};throw e}}}function tO(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}let tP={debug:!!(globalThis&&e3()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class tC extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class tA extends tC{}async function t$(e,t,s){tP.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),tP.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async r=>{if(r){tP.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await s()}finally{tP.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}else{if(0===t)throw tP.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new tA(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(tP.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();let tI={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:eI,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function tR(e,t,s){return await s()}let tL={};class tU{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=tU.nextInstanceID,tU.nextInstanceID+=1,this.instanceID>0&&e8()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let r=Object.assign(Object.assign({},tI),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new tN({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=e5(r.fetch),this.lock=r.lock||tR,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:e8()&&(null===(t=null==globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=t$:this.lock=tR,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:e3()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=tO(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=tO(this.memoryStorage)),e8()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}get jwks(){var e,t;return null!==(t=null===(e=tL[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){tL[this.storageKey]=Object.assign(Object.assign({},tL[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=tL[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){tL[this.storageKey]=Object.assign(Object.assign({},tL[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${e$}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t=function(e){let t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach((e,s)=>{t[s]=e})}catch(e){}return s.searchParams.forEach((e,s)=>{t[s]=e}),t}(window.location.href),s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),e8()&&this.detectSessionInUrl&&"none"!==s){let{data:r,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),eD(i)&&"AuthImplicitGrantRedirectError"===i.name){let t=null===(e=i.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:i}}return await this._removeSession(),{error:i}}let{session:n,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",n,"redirect type",a),await this._saveSession(n),setTimeout(async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(eD(e))return{error:e};return{error:new eq("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{let{data:i,error:n}=await tb(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:t_});if(n||!i)return{data:{user:null,session:null},error:n};let a=i.session,o=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:o,session:a},error:null}}catch(e){if(eD(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,s,r;try{let i;if("email"in e){let{email:s,password:r,options:n}=e,a=null,o=null;"pkce"===this.flowType&&([a,o]=await tl(this.storage,this.storageKey)),i=await tb(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==n?void 0:n.emailRedirectTo,body:{email:s,password:r,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:a,code_challenge_method:o},xform:t_})}else if("phone"in e){let{phone:t,password:n,options:a}=e;i=await tb(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:n,data:null!==(s=null==a?void 0:a.data)&&void 0!==s?s:{},channel:null!==(r=null==a?void 0:a.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:t_})}else throw new eG("You must provide either an email or phone number and a password");let{data:n,error:a}=i;if(a||!n)return{data:{user:null,session:null},error:a};let o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(eD(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:s,password:r,options:i}=e;t=await tb(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:tw})}else if("phone"in e){let{phone:s,password:r,options:i}=e;t=await tb(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:tw})}else throw new eG("You must provide either an email or phone number and a password");let{data:s,error:r}=t;if(r)return{data:{user:null,session:null},error:r};if(!s||!s.session||!s.user)return{data:{user:null,session:null},error:new ez};return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r}}catch(e){if(eD(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){let{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,r,i,n,a,o,l,c,h,u,d;let f,p;if("message"in e)f=e.message,p=e.signature;else{let u;let{chain:d,wallet:g,statement:m,options:y}=e;if(e8()){if("object"==typeof g)u=g;else{let e=window;if("solana"in e&&"object"==typeof e.solana&&("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))u=e.solana;else throw Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}}else{if("object"!=typeof g||!(null==y?void 0:y.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");u=g}let b=new URL(null!==(t=null==y?void 0:y.url)&&void 0!==t?t:window.location.href);if("signIn"in u&&u.signIn){let e;let t=await u.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==y?void 0:y.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),m?{statement:m}:null));if(Array.isArray(t)&&t[0]&&"object"==typeof t[0])e=t[0];else if(t&&"object"==typeof t&&"signedMessage"in t&&"signature"in t)e=t;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in e&&"signature"in e&&("string"==typeof e.signedMessage||e.signedMessage instanceof Uint8Array)&&e.signature instanceof Uint8Array)f="string"==typeof e.signedMessage?e.signedMessage:new TextDecoder().decode(e.signedMessage),p=e.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in u)||"function"!=typeof u.signMessage||!("publicKey"in u)||"object"!=typeof u||!u.publicKey||!("toBase58"in u.publicKey)||"function"!=typeof u.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${b.host} wants you to sign in with your Solana account:`,u.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${null!==(r=null===(s=null==y?void 0:y.signInWithSolana)||void 0===s?void 0:s.issuedAt)&&void 0!==r?r:new Date().toISOString()}`,...(null===(i=null==y?void 0:y.signInWithSolana)||void 0===i?void 0:i.notBefore)?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...(null===(n=null==y?void 0:y.signInWithSolana)||void 0===n?void 0:n.expirationTime)?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...(null===(a=null==y?void 0:y.signInWithSolana)||void 0===a?void 0:a.chainId)?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...(null===(o=null==y?void 0:y.signInWithSolana)||void 0===o?void 0:o.nonce)?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...(null===(l=null==y?void 0:y.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...(null===(h=null===(c=null==y?void 0:y.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===h?void 0:h.length)?["Resources",...y.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");let e=await u.signMessage(new TextEncoder().encode(f),"utf8");if(!e||!(e instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{let{data:t,error:s}=await tb(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:function(e){let t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};return e.forEach(e=>e1(e,s,r)),e1(null,s,r),t.join("")}(p)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:t_});if(s)throw s;if(!t||!t.session||!t.user)return{data:{user:null,session:null},error:new ez};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:s}}catch(e){if(eD(e))return{data:{user:null,session:null},error:e};throw e}}async _exchangeCodeForSession(e){let t=await te(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(null!=t?t:"").split("/");try{let{data:t,error:i}=await tb(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:t_});if(await tt(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!t||!t.session||!t.user)return{data:{user:null,session:null,redirectType:null},error:new ez};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:i}}catch(e){if(eD(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{let{options:t,provider:s,token:r,access_token:i,nonce:n}=e,{data:a,error:o}=await tb(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:n,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:t_});if(o)return{data:{user:null,session:null},error:o};if(!a||!a.session||!a.user)return{data:{user:null,session:null},error:new ez};return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:o}}catch(e){if(eD(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,s,r,i,n;try{if("email"in e){let{email:r,options:i}=e,n=null,a=null;"pkce"===this.flowType&&([n,a]=await tl(this.storage,this.storageKey));let{error:o}=await tb(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(s=null==i?void 0:i.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:n,code_challenge_method:a},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){let{phone:t,options:s}=e,{data:a,error:o}=await tb(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},create_user:null===(i=null==s?void 0:s.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(n=null==s?void 0:s.channel)&&void 0!==n?n:"sms"}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:o}}throw new eG("You must provide either an email or phone number.")}catch(e){if(eD(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,s;try{let r,i;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(s=e.options)||void 0===s?void 0:s.captchaToken);let{data:n,error:a}=await tb(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:t_});if(a)throw a;if(!n)throw Error("An error occurred on token verification.");let o=n.session,l=n.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(eD(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,s,r;try{let i=null,n=null;return"pkce"===this.flowType&&([i,n]=await tl(this.storage,this.storageKey)),await tb(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:n}),headers:this.headers,xform:tk})}catch(e){if(eD(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new eW;let{error:r}=await tb(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(eD(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:s,type:r,options:i}=e,{error:n}=await tb(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:n}}if("phone"in e){let{phone:s,type:r,options:i}=e,{data:n,error:a}=await tb(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:a}}throw new eG("You must provide either an email or phone number and a type")}catch(e){if(eD(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(e){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,t=await te(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let s=!!e.expires_at&&1e3*e.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){let t=await te(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=td()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,r)=>(t||"user"!==s||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,r))})}return{data:{session:e},error:null}}let{session:r,error:i}=await this._callRefreshToken(e.refresh_token);if(i)return{data:{session:null},error:i};return{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{if(e)return await tb(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:tx});return await this._useSession(async e=>{var t,s,r;let{data:i,error:n}=e;if(n)throw n;return(null===(t=i.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await tb(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0,xform:tx}):{data:{user:null},error:new eW}})}catch(e){if(eD(e))return eD(e)&&"AuthSessionMissingError"===e.name&&(await this._removeSession(),await tt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{let{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new eW;let n=r.session,a=null,o=null;"pkce"===this.flowType&&null!=e.email&&([a,o]=await tl(this.storage,this.storageKey));let{data:l,error:c}=await tb(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:o}),jwt:n.access_token,xform:tx});if(c)throw c;return n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),{data:{user:n.user},error:null}})}catch(e){if(eD(e))return{data:{user:null},error:e};throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new eW;let t=Date.now()/1e3,s=t,r=!0,i=null,{payload:n}=tr(e.access_token);if(n.exp&&(r=(s=n.exp)<=t),r){let{session:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};i=t}else{let{data:r,error:n}=await this._getUser(e.access_token);if(n)throw n;i={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(e){if(eD(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){let{data:r,error:i}=t;if(i)throw i;e=null!==(s=r.session)&&void 0!==s?s:void 0}if(!(null==e?void 0:e.refresh_token))throw new eW;let{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(eD(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!e8())throw new eH("No browser detected.");if(e.error||e.error_description||e.error_code)throw new eH(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new eV("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new eH("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new eV("No code detected.");let{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;let r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}let{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:n,expires_in:a,expires_at:o,token_type:l}=e;if(!i||!a||!n||!l)throw new eH("No session defined in URL");let c=Math.round(Date.now()/1e3),h=parseInt(a),u=c+h;o&&(u=parseInt(o));let d=u-c;1e3*d<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${h}s`);let f=u-h;c-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,u,c):c-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,u,c);let{data:p,error:g}=await this._getUser(i);if(g)throw g;let m={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:h,expires_at:u,refresh_token:n,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(e){if(eD(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await te(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;let{data:r,error:i}=t;if(i)return{error:i};let n=null===(s=r.session)||void 0===s?void 0:s.access_token;if(n){let{error:t}=await this.admin.signOut(n,e);if(t&&!(eD(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)))return{error:t}}return"others"!==e&&(await this._removeSession(),await tt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{let{data:{session:r},error:i}=t;if(i)throw i;await (null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(t){await (null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;"pkce"===this.flowType&&([s,r]=await tl(this.storage,this.storageKey,!0));try{return await tb(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(eD(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{let{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(e){if(eD(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{let{data:s,error:r}=await this._useSession(async t=>{var s,r,i,n,a;let{data:o,error:l}=t;if(l)throw l;let c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await tb(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(a=null===(n=o.session)||void 0===n?void 0:n.access_token)&&void 0!==a?a:void 0})});if(r)throw r;return!e8()||(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)||window.location.assign(null==s?void 0:s.url),{data:{provider:e.provider,url:null==s?void 0:s.url},error:null}}catch(t){if(eD(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,r;let{data:i,error:n}=t;if(n)throw n;return await tb(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0})})}catch(e){if(eD(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var s,r;let i=Date.now();return await (s=async s=>(s>0&&await ti(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await tb(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:t_})),r=(e,t)=>t&&eJ(t)&&Date.now()+200*Math.pow(2,e)-i<3e4,new Promise((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{let t=await s(i);if(!r(i,null,t)){e(t);return}}catch(e){if(!r(i,e)){t(e);return}}})()}))}catch(e){if(this._debug(t,"error",e),eD(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),e8()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;let s="#_recoverAndRefresh()";this._debug(s,"begin");try{let r=await te(this.storage,this.storageKey);if(r&&this.userStorage){let t=await te(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!t&&(t={user:r.user},await e7(this.userStorage,this.storageKey+"-user",t)),r.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:td()}else if(r&&!r.user&&!r.user){let e=await te(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(r.user=e.user,await tt(this.storage,this.storageKey+"-user"),await e7(this.storage,this.storageKey,r)):r.user=td()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),null!==r&&await this._removeSession();return}let i=(null!==(t=r.expires_at)&&void 0!==t?t:1/0)*1e3-Date.now()<9e4;if(this._debug(s,`session has${i?"":" not"} expired with margin of 90000s`),i){if(this.autoRefreshToken&&r.refresh_token){let{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),eJ(e)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(r.user&&!0===r.user.__isUserNotAvailableProxy)try{let{data:e,error:t}=await this._getUser(r.access_token);!t&&(null==e?void 0:e.user)?(r.user=e.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(e){console.error("Error getting user data:",e),this._debug(s,"error getting user data, skipping SIGNED_IN notification",e)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(e){this._debug(s,"error",e),console.error(e);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new eW;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new ts;let{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new eW;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(e){if(this._debug(r,"error",e),eD(e)){let s={session:null,error:e};return eJ(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(s),s}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(e),e}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){let r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});let r=[],i=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(e,t)}catch(e){r.push(e)}});if(await Promise.all(i),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;let t=Object.assign({},e),s=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!s&&t.user&&await e7(this.userStorage,this.storageKey+"-user",{user:t.user});let e=Object.assign({},t);delete e.user;let r=structuredClone(e);await e7(this.storage,this.storageKey,r)}else{let e=structuredClone(t);await e7(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await tt(this.storage,this.storageKey),await tt(this.storage,this.storageKey+"-code-verifier"),await tt(this.storage,this.storageKey+"-user"),this.userStorage&&await tt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&e8()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let r=Math.floor((1e3*s.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(s.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof tC)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!e8()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if("visible"!==document.visibilityState){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){let r=[`provider=${encodeURIComponent(t)}`];if((null==s?void 0:s.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){let[e,t]=await tl(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(s.toString())}if(null==s?void 0:s.queryParams){let e=new URLSearchParams(s.queryParams);r.push(e.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;let{data:r,error:i}=t;return i?{data:null,error:i}:await tb(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})})}catch(e){if(eD(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;let{data:i,error:n}=t;if(n)return{data:null,error:n};let a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await tb(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null===(s=null==i?void 0:i.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null==o?void 0:o.totp)||void 0===r?void 0:r.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(e){if(eD(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;let{data:r,error:i}=t;if(i)return{data:null,error:i};let{data:n,error:a}=await tb(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+n.expires_in},n)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",n),{data:n,error:a})})}catch(e){if(eD(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;let{data:r,error:i}=t;return i?{data:null,error:i}:await tb(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})})}catch(e){if(eD(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){let{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){let{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};let s=(null==e?void 0:e.factors)||[],r=s.filter(e=>"totp"===e.factor_type&&"verified"===e.status),i=s.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:s,totp:r,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;let{data:{session:r},error:i}=e;if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:n}=tr(r.access_token),a=null;n.aal&&(a=n.aal);let o=a;return(null!==(s=null===(t=r.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==s?s:[]).length>0&&(o="aal2"),{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:n.amr||[]},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(t=>t.kid===e);if(s)return s;let r=Date.now();if((s=this.jwks.keys.find(t=>t.kid===e))&&this.jwks_cached_at+6e5>r)return s;let{data:i,error:n}=await tb(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(n)throw n;return i.keys&&0!==i.keys.length&&(this.jwks=i,this.jwks_cached_at=r,s=i.keys.find(t=>t.kid===e))?s:null}async getClaims(e,t={}){try{let s=e;if(!s){let{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};s=e.session.access_token}let{header:r,payload:i,signature:n,raw:{header:a,payload:o}}=tr(s);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(i.exp);let l=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks);if(!l){let{error:e}=await this.getUser(s);if(e)throw e;return{data:{claims:i,header:r,signature:n},error:null}}let c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(r.alg),h=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,n,function(e){let t=[];return function(e,t){for(let s=0;s<e.length;s+=1){let r=e.charCodeAt(s);if(r>55295&&r<=56319){let t=(r-55296)*1024&65535;r=(e.charCodeAt(s+1)-56320&65535|t)+65536,s+=1}!function(e,t){if(e<=127){t(e);return}if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(r,t)}}(e,e=>t.push(e)),new Uint8Array(t)}(`${a}.${o}`)))throw new eY("Invalid JWT signature");return{data:{claims:i,header:r,signature:n},error:null}}catch(e){if(eD(e))return{data:null,error:e};throw e}}}tU.nextInstanceID=0;let tB=tU;class tD extends tB{constructor(e){super(e)}}class tM{constructor(e,t,s){var r,i,n;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw Error("supabaseUrl is required.");if(!t)throw Error("supabaseKey is required.");let a=new URL(function(e){return e.endsWith("/")?e:e+"/"}(e));this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);let o=`sb-${a.hostname.split(".")[0]}-auth-token`,l=function(e,t){var s,r;let{db:i,auth:n,realtime:a,global:o}=e,{db:l,auth:c,realtime:h,global:u}=t,d={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},c),n),realtime:Object.assign(Object.assign({},h),a),global:Object.assign(Object.assign(Object.assign({},u),o),{headers:Object.assign(Object.assign({},null!==(s=null==u?void 0:u.headers)&&void 0!==s?s:{}),null!==(r=null==o?void 0:o.headers)&&void 0!==r?r:{})}),accessToken:()=>{var e,t,s,r;return e=this,t=void 0,r=function*(){return""},new(s=void 0,s=Promise)(function(i,n){function a(e){try{l(r.next(e))}catch(e){n(e)}}function o(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})}};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!=s?s:{},{db:eS,realtime:eT,auth:Object.assign(Object.assign({},eE),{storageKey:o}),global:ej});this.storageKey=null!==(r=l.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(i=l.global.headers)&&void 0!==i?i:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(n=l.auth)&&void 0!==n?n:{},this.headers,l.global.fetch),this.fetch=eA(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new k(new URL("rest/v1",a).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new x(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ex(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,s,r,i,n;return s=this,r=void 0,i=void 0,n=function*(){if(this.accessToken)return yield this.accessToken();let{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null},new(i||(i=Promise))(function(e,t){function a(e){try{l(n.next(e))}catch(e){t(e)}}function o(e){try{l(n.throw(e))}catch(e){t(e)}}function l(t){var s;t.done?e(t.value):((s=t.value)instanceof i?s:new i(function(e){e(s)})).then(a,o)}l((n=n.apply(s,r||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:i,flowType:n,lock:a,debug:o},l,c){let h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new tD({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),l),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:n,lock:a,debug:o,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Q(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,s){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==s?this.changedAccessToken=s:"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}}let tq=new tM("https://nmjvebcauoyqzjlnluos.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5tanZlYmNhdW95cXpqbG5sdW9zIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIzNDUwMDksImV4cCI6MjA2NzkyMTAwOX0.zCo7UC0Vb0wIUT0mAPk6qknKe0iQbY7dgGVXwUmqXGI",void 0);var tF=s(30454),tW=s(36695),tz=s(49670),tG=s(47668);let tH=(0,tG.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var tV=s(75506);let tK=(0,tG.Z)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),tJ=(0,tG.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var tZ=s(73954);let tY=(0,tG.Z)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),tX=(0,tG.Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),tQ=(0,tG.Z)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);var t0=s(82463);function t1({onSignIn:e,onStartTrading:t}){return g.jsx("nav",{className:"bg-white border-b border-gray-200 sticky top-0 z-50",children:g.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,g.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,g.jsxs)("div",{className:"flex items-center space-x-3",children:[g.jsx(t0.default,{href:"/",className:"w-8 h-8 bg-[#00a489] rounded-lg flex items-center justify-center",children:g.jsx("span",{className:"text-white font-bold text-lg",children:"A"})}),g.jsx("span",{className:"text-xl font-bold text-[#383838]",children:"ATOM"})]}),(0,g.jsxs)("div",{className:"hidden md:flex items-center space-x-8",children:[g.jsx(t0.default,{href:"/platform",className:"text-gray-600 hover:text-[#00a489] transition-colors",children:"Platform"}),g.jsx(t0.default,{href:"/security",className:"text-gray-600 hover:text-[#00a489] transition-colors",children:"Security"}),g.jsx(t0.default,{href:"/pricing",className:"text-gray-600 hover:text-[#00a489] transition-colors",children:"Pricing"}),g.jsx("button",{onClick:e,className:"bg-[#00a489] text-white px-6 py-2 rounded-lg font-semibold hover:bg-[#008a73] transition-colors",children:"Sign In"}),g.jsx("button",{onClick:t,className:"bg-[#4c82f7] text-white px-6 py-2 rounded-lg font-semibold hover:bg-[#3b72e6] transition-colors",children:"Start Trading"})]})]})})})}function t2({onEnterApp:e}){let[t,s]=(0,m.useState)(!1),[r,i]=(0,m.useState)(""),[n,a]=(0,m.useState)(""),[o,l]=(0,m.useState)(5),c=[{icon:tF.Z,title:"Lightning-Fast Execution",description:"Sub-millisecond execution with advanced routing algorithms",metric:"< 50ms latency"},{icon:tW.Z,title:"Bank-Level Security",description:"Military-grade encryption and SOC 2 compliance",metric:"SOC 2 Certified"},{icon:tz.Z,title:"AI-Powered Analysis",description:"24/7 opportunity detection across 50+ exchanges",metric:"94.7% accuracy"}],h=[{icon:tW.Z,name:"SEC Compliant"},{icon:tH,name:"256-bit SSL"},{icon:tV.Z,name:"Audited"},{icon:tK,name:"99.9% Uptime"}];return(0,g.jsxs)("div",{className:"min-h-screen bg-white",children:[g.jsx(t1,{onSignIn:async()=>{await tq.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}})},onStartTrading:async()=>{await tq.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}})}}),g.jsx("section",{className:"relative bg-gradient-to-br from-gray-50 to-white py-20",children:g.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,g.jsxs)("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[(0,g.jsxs)("div",{className:"space-y-8",children:[(0,g.jsxs)("div",{className:"inline-flex items-center space-x-2 bg-[#00a489]/10 text-[#00a489] px-4 py-2 rounded-full",children:[g.jsx(tW.Z,{className:"w-4 h-4"}),g.jsx("span",{className:"text-sm font-semibold",children:"SEC Compliant • Bank-Level Security • 99.9% Uptime"})]}),(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("h1",{className:"text-5xl lg:text-6xl font-bold text-[#383838] leading-tight",children:["Institutional-Grade",g.jsx("span",{className:"block text-[#00a489]",children:"Arbitrage Trading"})]}),g.jsx("p",{className:"text-xl text-gray-600 leading-relaxed",children:"Capture profit opportunities across 50+ exchanges with AI-powered arbitrage detection and automated execution. Join 4,000+ traders earning consistent returns."})]}),(0,g.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,g.jsxs)("button",{onClick:e,className:"bg-[#00a489] text-white px-8 py-4 rounded-lg font-semibold hover:bg-[#008a73] transition-all transform hover:scale-105 flex items-center justify-center space-x-2",children:[g.jsx("span",{children:"Start Trading Now"}),g.jsx(tJ,{className:"w-5 h-5"})]}),(0,g.jsxs)("button",{className:"border-2 border-[#00a489] text-[#00a489] px-8 py-4 rounded-lg font-semibold hover:bg-[#00a489]/5 transition-all flex items-center justify-center space-x-2",children:[g.jsx("span",{children:"View Live Demo"}),g.jsx(tZ.Z,{className:"w-5 h-5"})]})]}),g.jsx("div",{className:"flex flex-wrap gap-6 pt-4",children:h.map((e,t)=>(0,g.jsxs)("div",{className:"flex items-center space-x-2 text-gray-600",children:[g.jsx(e.icon,{className:"w-5 h-5 text-[#00a489]"}),g.jsx("span",{className:"text-sm font-medium",children:e.name})]},t))})]}),g.jsx("div",{className:"lg:pl-12",children:g.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:(0,g.jsxs)("div",{className:"space-y-6",children:[(0,g.jsxs)("div",{className:"text-center",children:[g.jsx("h3",{className:"text-2xl font-bold text-[#383838] mb-2",children:"Access Your Dashboard"}),g.jsx("p",{className:"text-gray-600",children:"Trade with confidence on our secure platform"})]}),(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),g.jsx("input",{type:"email",value:r,onChange:e=>i(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00a489] focus:border-[#00a489] transition-colors",placeholder:"you@company.com"})]}),(0,g.jsxs)("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,g.jsxs)("div",{className:"relative",children:[g.jsx("input",{type:t?"text":"password",value:n,onChange:e=>a(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#00a489] focus:border-[#00a489] transition-colors pr-12",placeholder:"••••••••"}),g.jsx("button",{type:"button",onClick:()=>s(!t),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:t?g.jsx(tY,{className:"w-5 h-5 text-gray-400"}):g.jsx(tX,{className:"w-5 h-5 text-gray-400"})})]})]}),(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("label",{className:"flex items-center",children:[g.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-[#00a489] focus:ring-[#00a489]"}),g.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Remember me"})]}),g.jsx("a",{href:"#",className:"text-sm text-[#00a489] hover:underline",children:"Forgot password?"})]}),g.jsx("button",{onClick:()=>{e()},className:"w-full bg-[#00a489] text-white py-3 rounded-lg font-semibold hover:bg-[#008a73] transition-colors",children:"Sign In"})]}),(0,g.jsxs)("div",{className:"relative",children:[g.jsx("div",{className:"absolute inset-0 flex items-center",children:g.jsx("div",{className:"w-full border-t border-gray-200"})}),g.jsx("div",{className:"relative flex justify-center text-sm",children:g.jsx("span",{className:"px-4 bg-white text-gray-500",children:"Or continue with"})})]}),(0,g.jsxs)("button",{onClick:async()=>{await tq.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}})},className:"flex items-center justify-center space-x-3 w-full px-4 py-3 border border-gray-300 rounded-lg bg-white hover:bg-gray-50 transition-colors",children:[(0,g.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[g.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),g.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),g.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),g.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),g.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Continue with Google"})]}),(0,g.jsxs)("div",{className:"relative",children:[g.jsx("div",{className:"absolute inset-0 flex items-center",children:g.jsx("div",{className:"w-full border-t border-gray-200"})}),g.jsx("div",{className:"relative flex justify-center text-sm",children:g.jsx("span",{className:"px-4 bg-white text-gray-500",children:"New to ATOM?"})})]}),g.jsx("button",{className:"w-full border-2 border-[#00a489] text-[#00a489] py-3 rounded-lg font-semibold hover:bg-[#00a489]/5 transition-all",children:"Create Free Account"}),(0,g.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-500",children:[g.jsx(tH,{className:"w-4 h-4"}),g.jsx("span",{children:"256-bit SSL Encrypted"})]})]})})})]})})}),g.jsx("section",{className:"bg-[#383838] py-4",children:g.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,g.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[g.jsx("div",{className:"flex items-center space-x-8",children:(0,g.jsxs)("div",{className:"flex items-center space-x-2",children:[g.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),g.jsx("span",{className:"text-white text-sm",children:"Live Trading"})]})}),(0,g.jsxs)("div",{className:"flex items-center space-x-4",children:[g.jsx("span",{className:"text-sm text-gray-400",children:"Next scan:"}),(0,g.jsxs)("span",{className:"text-white font-mono",children:["00:0",o]})]})]})})}),g.jsx("section",{className:"py-20 bg-gray-50",children:(0,g.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,g.jsxs)("div",{className:"text-center space-y-4 mb-16",children:[(0,g.jsxs)("h2",{className:"text-4xl font-bold text-[#383838]",children:["Why Traders Choose ",g.jsx("span",{className:"text-[#00a489]",children:"ATOM"})]}),g.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Our platform combines institutional-grade infrastructure with cutting-edge AI to deliver consistent arbitrage profits"})]}),g.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:c.map((e,t)=>(0,g.jsxs)("div",{className:"bg-white rounded-xl p-8 shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1",children:[g.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-[#00a489] to-[#4cb99f] rounded-lg flex items-center justify-center mb-6",children:g.jsx(e.icon,{className:"w-8 h-8 text-white"})}),g.jsx("h3",{className:"text-xl font-bold text-[#383838] mb-3",children:e.title}),g.jsx("p",{className:"text-gray-600 mb-4",children:e.description}),g.jsx("div",{className:"text-[#00a489] font-semibold",children:e.metric})]},t))})]})}),g.jsx("section",{className:"py-20 bg-[#383838]",children:(0,g.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,g.jsxs)("div",{className:"text-center space-y-4 mb-16",children:[(0,g.jsxs)("h2",{className:"text-4xl font-bold text-white",children:["Your Funds Are ",g.jsx("span",{className:"text-[#00a489]",children:"Protected"})]}),g.jsx("p",{className:"text-xl text-gray-300 max-w-3xl mx-auto",children:"We implement enterprise-grade security measures to ensure your assets and data remain safe at all times"})]}),g.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[{icon:tW.Z,title:"Multi-Signature Wallets",description:"All funds stored in multi-signature cold wallets with distributed key management"},{icon:tH,title:"Advanced Encryption",description:"256-bit encryption for all data with end-to-end secure communication protocols"},{icon:tV.Z,title:"Regulatory Compliance",description:"Fully compliant with SEC regulations and SOC 2 Type II certified"}].map((e,t)=>(0,g.jsxs)("div",{className:"bg-gray-800 rounded-xl p-8 text-center",children:[g.jsx("div",{className:"w-14 h-14 bg-[#00a489] rounded-lg flex items-center justify-center mx-auto mb-6",children:g.jsx(e.icon,{className:"w-8 h-8 text-white"})}),g.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:e.title}),g.jsx("p",{className:"text-gray-300",children:e.description})]},t))})]})}),g.jsx("section",{className:"py-20 bg-gradient-to-br from-[#00a489] to-[#4cb99f]",children:(0,g.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[g.jsx("h2",{className:"text-4xl font-bold text-white mb-6",children:"Start Earning Arbitrage Profits Today"}),g.jsx("p",{className:"text-xl text-white/90 mb-8",children:"Join thousands of traders who are already profiting from market inefficiencies. No credit card required for your 30-day trial."}),(0,g.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[g.jsx("button",{onClick:e,className:"bg-white text-[#00a489] px-8 py-4 rounded-lg font-semibold hover:bg-gray-100 transition-all transform hover:scale-105",children:"Create Free Account"}),g.jsx("button",{className:"border-2 border-white text-white px-8 py-4 rounded-lg font-semibold hover:bg-white/10 transition-all",children:"Schedule Demo"})]})]})}),g.jsx("footer",{className:"bg-[#383838] text-white py-12",children:(0,g.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,g.jsxs)("div",{className:"grid md:grid-cols-4 gap-8",children:[(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("div",{className:"flex items-center space-x-3",children:[g.jsx("div",{className:"w-8 h-8 bg-[#00a489] rounded-lg flex items-center justify-center",children:g.jsx(tF.Z,{className:"w-5 h-5 text-white"})}),g.jsx("span",{className:"text-xl font-bold",children:"ATOM"})]}),g.jsx("p",{className:"text-gray-400",children:"The future of institutional arbitrage trading. Powered by AI, secured by blockchain."})]}),(0,g.jsxs)("div",{children:[g.jsx("h4",{className:"font-semibold mb-4",children:"Platform"}),(0,g.jsxs)("ul",{className:"space-y-2 text-gray-400",children:[g.jsx("li",{children:g.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Features"})}),g.jsx("li",{children:g.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Security"})}),g.jsx("li",{children:g.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Pricing"})}),g.jsx("li",{children:g.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"API"})})]})]}),(0,g.jsxs)("div",{children:[g.jsx("h4",{className:"font-semibold mb-4",children:"Company"}),(0,g.jsxs)("ul",{className:"space-y-2 text-gray-400",children:[g.jsx("li",{children:g.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"About Us"})}),g.jsx("li",{children:g.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Careers"})}),g.jsx("li",{children:g.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Press"})}),g.jsx("li",{children:g.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Contact"})})]})]}),(0,g.jsxs)("div",{children:[g.jsx("h4",{className:"font-semibold mb-4",children:"Legal"}),(0,g.jsxs)("ul",{className:"space-y-2 text-gray-400",children:[g.jsx("li",{children:g.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Privacy Policy"})}),g.jsx("li",{children:g.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Terms of Service"})}),g.jsx("li",{children:g.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Risk Disclosure"})}),g.jsx("li",{children:g.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Compliance"})})]})]})]}),(0,g.jsxs)("div",{className:"border-t border-gray-700 mt-8 pt-8 flex flex-col sm:flex-row justify-between items-center",children:[g.jsx("p",{className:"text-gray-400 text-sm",children:"\xa9 2024 ATOM Arbitrage. All rights reserved."}),(0,g.jsxs)("div",{className:"flex space-x-6 mt-4 sm:mt-0",children:[(0,g.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-400",children:[g.jsx(tW.Z,{className:"w-4 h-4"}),g.jsx("span",{children:"SEC Compliant"})]}),(0,g.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-400",children:[g.jsx(tH,{className:"w-4 h-4"}),g.jsx("span",{children:"FINRA Member"})]}),(0,g.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-400",children:[g.jsx(tQ,{className:"w-4 h-4"}),g.jsx("span",{children:"SOC 2 Type II"})]})]})]})]})})]})}var t4=s(14512),t8=s(29806),t6=s(42230),t3=s(87610),t5=s(18740),t9=s(44991),t7=s(93291),se=s(1130),st=s(21549),ss=s(88544),sr=s(84306);let si={dashboard:function(){let{state:e,actions:t}=(0,t4.b)(),{isDark:s,showBalance:r,tradingMetrics:i,opportunities:n,botStatus:a}=e;return(0,g.jsxs)("div",{className:"p-6 space-y-6",children:[(0,g.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[g.jsx("div",{className:`p-6 rounded-xl ${s?"bg-gray-800":"bg-white"} border border-gray-200 dark:border-gray-700 shadow-sm`,children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[g.jsx("p",{className:"text-sm text-gray-500",children:"Total Profit"}),(0,g.jsxs)("p",{className:"text-2xl font-bold text-green-500",children:["$",r?i.totalProfit.toLocaleString():"****"]}),g.jsx("p",{className:"text-sm text-gray-500",children:"+12.4% this month"})]}),g.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:g.jsx(t3.Z,{className:"w-6 h-6 text-green-600"})})]})}),g.jsx("div",{className:`p-6 rounded-xl ${s?"bg-gray-800":"bg-white"} border border-gray-200 dark:border-gray-700 shadow-sm`,children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[g.jsx("p",{className:"text-sm text-gray-500",children:"Today's Profit"}),(0,g.jsxs)("p",{className:"text-2xl font-bold text-blue-500",children:["$",r?i.todayProfit.toFixed(2):"****"]}),(0,g.jsxs)("p",{className:"text-sm text-gray-500",children:["+",i.avgReturn,"% avg return"]})]}),g.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:g.jsx(t5.Z,{className:"w-6 h-6 text-blue-600"})})]})}),g.jsx("div",{className:`p-6 rounded-xl ${s?"bg-gray-800":"bg-white"} border border-gray-200 dark:border-gray-700 shadow-sm`,children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[g.jsx("p",{className:"text-sm text-gray-500",children:"Success Rate"}),(0,g.jsxs)("p",{className:"text-2xl font-bold",children:[i.successRate,"%"]}),(0,g.jsxs)("p",{className:"text-sm text-gray-500",children:[i.totalTrades," total trades"]})]}),g.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:g.jsx(tZ.Z,{className:"w-6 h-6 text-purple-600"})})]})}),g.jsx("div",{className:`p-6 rounded-xl ${s?"bg-gray-800":"bg-white"} border border-gray-200 dark:border-gray-700 shadow-sm`,children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[g.jsx("p",{className:"text-sm text-gray-500",children:"Active Trades"}),g.jsx("p",{className:"text-2xl font-bold",children:i.activeTrades}),(0,g.jsxs)("p",{className:"text-sm text-gray-500",children:["Flash loan volume: $",i.flashLoanVolume.toLocaleString()]})]}),g.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/30 rounded-lg",children:g.jsx(tF.Z,{className:"w-6 h-6 text-orange-600"})})]})})]}),(0,g.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,g.jsxs)("div",{className:`p-6 rounded-xl ${s?"bg-gray-800":"bg-white"} border border-gray-200 dark:border-gray-700 shadow-sm`,children:[(0,g.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold",children:"Bot Status"}),(0,g.jsxs)("button",{onClick:()=>{t.setBotStatus("running"===a?"stopped":"running")},className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all ${"running"===a?"bg-red-500 text-white hover:bg-red-600":"bg-green-500 text-white hover:bg-green-600"}`,children:["running"===a?g.jsx(t9.Z,{className:"w-4 h-4"}):g.jsx(t7.Z,{className:"w-4 h-4"}),g.jsx("span",{children:"running"===a?"Stop Bot":"Start Bot"})]})]}),(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-gray-500",children:"Status"}),g.jsx("span",{className:`font-medium capitalize ${"running"===a?"text-green-500":"paused"===a?"text-yellow-500":"text-gray-500"}`,children:a})]}),(0,g.jsxs)("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-gray-500",children:"Uptime"}),g.jsx("span",{children:"4h 23m"})]}),(0,g.jsxs)("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-gray-500",children:"Next Scan"}),g.jsx("span",{children:"12s"})]}),(0,g.jsxs)("div",{className:"flex justify-between",children:[g.jsx("span",{className:"text-gray-500",children:"Gas Price"}),g.jsx("span",{children:"23 gwei"})]})]})]}),(0,g.jsxs)("div",{className:`p-6 rounded-xl ${s?"bg-gray-800":"bg-white"} border border-gray-200 dark:border-gray-700 shadow-sm`,children:[(0,g.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[g.jsx("h3",{className:"text-lg font-semibold",children:"Live Opportunities"}),(0,g.jsxs)("div",{className:"flex items-center space-x-2",children:[g.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),g.jsx("span",{className:"text-sm text-green-500",children:"Live"})]})]}),g.jsx("div",{className:"space-y-3",children:n.slice(0,4).map(e=>g.jsx("div",{className:`p-3 rounded-lg ${s?"bg-gray-700":"bg-gray-50"}`,children:(0,g.jsxs)("div",{className:"flex justify-between items-center",children:[(0,g.jsxs)("div",{children:[g.jsx("p",{className:"font-medium",children:e.pair}),(0,g.jsxs)("p",{className:"text-sm text-gray-500",children:[e.dex1," → ",e.dex2]})]}),(0,g.jsxs)("div",{className:"text-right",children:[(0,g.jsxs)("p",{className:"text-green-500 font-semibold",children:["+",e.spread.toFixed(2),"%"]}),(0,g.jsxs)("p",{className:"text-sm text-gray-500",children:["$",e.profit.toFixed(0)]})]})]})},e.id))})]})]})]})},bot:se.BotControlPage,opportunities:st.OpportunitiesPage,analytics:function(){let{state:e}=(0,t4.b)(),{isDark:t}=e;return(0,g.jsxs)("div",{className:"p-6",children:[(0,g.jsxs)("div",{className:"mb-6",children:[g.jsx("h1",{className:"text-3xl font-bold",children:"Analytics"}),g.jsx("p",{className:`mt-2 ${t?"text-gray-400":"text-gray-500"}`,children:"Detailed performance analytics and insights"})]}),g.jsx(sr.F,{}),(0,g.jsxs)("div",{className:`mt-8 p-8 rounded-lg border-2 border-dashed ${t?"border-gray-600":"border-gray-300"} text-center`,children:[g.jsx("h3",{className:"text-lg font-medium mb-2",children:"Advanced Analytics Coming Soon"}),g.jsx("p",{className:t?"text-gray-400":"text-gray-500",children:"Detailed charts, performance metrics, and trading insights will be available here."})]})]})},history:function(){let{state:e}=(0,t4.b)(),{isDark:t}=e;return(0,g.jsxs)("div",{className:"p-6",children:[(0,g.jsxs)("div",{className:"mb-6",children:[g.jsx("h1",{className:"text-3xl font-bold",children:"Trade History"}),g.jsx("p",{className:`mt-2 ${t?"text-gray-400":"text-gray-500"}`,children:"Complete history of all executed trades"})]}),(0,g.jsxs)("div",{className:`p-8 rounded-lg border-2 border-dashed ${t?"border-gray-600":"border-gray-300"} text-center`,children:[g.jsx("h3",{className:"text-lg font-medium mb-2",children:"Trade History Coming Soon"}),g.jsx("p",{className:t?"text-gray-400":"text-gray-500",children:"Detailed trade history with filters, search, and export functionality will be available here."})]})]})},settings:ss.SettingsPage};function sn(){let[e,t]=(0,m.useState)(!1),{state:s,actions:r}=(0,t4.b)(),{currentPage:i,isDark:n,isMobile:a,isSidebarOpen:o}=s;if(!e)return g.jsx(t2,{onEnterApp:()=>t(!0)});let l=si[i]||si.dashboard;return(0,g.jsxs)("div",{className:`min-h-screen ${n?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"}`,children:[(0,g.jsxs)("div",{className:"flex",children:[!a&&g.jsx(t8.I,{}),(0,g.jsxs)("div",{className:"flex-1",children:[g.jsx(t6.h,{}),g.jsx("main",{className:"overflow-auto",children:g.jsx(l,{})})]})]}),a&&o&&(0,g.jsxs)(g.Fragment,{children:[g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:r.toggleSidebar}),g.jsx(t8.I,{className:"fixed inset-y-0 left-0 z-50"})]})]})}function sa(){let{user:e,loading:t}=function(){let[e,t]=(0,m.useState)(null),[s,r]=(0,m.useState)(!0);return{user:e,loading:s,signInWithGoogle:async()=>{let{error:e}=await tq.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}});if(e)throw e},signOut:async()=>{let{error:e}=await tq.auth.signOut();if(e)throw e}}}(),[s,r]=(0,m.useState)(!1);return t?g.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:g.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#00a489]"})}):e||s?g.jsx(t4.AppProvider,{children:g.jsx(sn,{})}):g.jsx(t2,{onEnterApp:()=>r(!0)})}},84306:(e,t,s)=>{"use strict";s.d(t,{F:()=>c});var r=s(99888);s(89671);var i=s(14512),n=s(87610),a=s(18740),o=s(73954),l=s(30454);function c(){let{state:e}=(0,i.b)(),{isDark:t,showBalance:s,tradingMetrics:c}=e;return(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r.jsx("div",{className:`p-6 rounded-xl ${t?"bg-gray-800":"bg-white"} border border-gray-200 dark:border-gray-700 shadow-sm`,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Total Profit"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-green-500",children:["$",s?c.totalProfit.toLocaleString():"****"]})]}),r.jsx(n.Z,{className:"w-8 h-8 text-green-500"})]})}),r.jsx("div",{className:`p-6 rounded-xl ${t?"bg-gray-800":"bg-white"} border border-gray-200 dark:border-gray-700 shadow-sm`,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Today's Profit"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-blue-500",children:["$",s?c.todayProfit.toFixed(2):"****"]})]}),r.jsx(a.Z,{className:"w-8 h-8 text-blue-500"})]})}),r.jsx("div",{className:`p-6 rounded-xl ${t?"bg-gray-800":"bg-white"} border border-gray-200 dark:border-gray-700 shadow-sm`,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Success Rate"}),(0,r.jsxs)("p",{className:"text-2xl font-bold",children:[c.successRate,"%"]})]}),r.jsx(o.Z,{className:"w-8 h-8 text-purple-500"})]})}),r.jsx("div",{className:`p-6 rounded-xl ${t?"bg-gray-800":"bg-white"} border border-gray-200 dark:border-gray-700 shadow-sm`,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-gray-500",children:"Active Trades"}),r.jsx("p",{className:"text-2xl font-bold",children:c.activeTrades})]}),r.jsx(l.Z,{className:"w-8 h-8 text-orange-500"})]})})]})}},88544:(e,t,s)=>{"use strict";s.d(t,{SettingsPage:()=>n});var r=s(99888);s(89671);var i=s(14512);function n(){let{state:e,actions:t}=(0,i.b)(),{isDark:s,theme:n,showBalance:a}=e,o={blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",orange:"bg-orange-500",red:"bg-red-500",pink:"bg-pink-500"};return(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Settings"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:`p-6 rounded-xl ${s?"bg-gray-800":"bg-white"} border border-gray-200 dark:border-gray-700 shadow-sm`,children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Theme Customization"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Color Theme"}),r.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.entries(o).map(([e,s])=>(0,r.jsxs)("button",{onClick:()=>t.setTheme(e),className:`p-3 rounded-lg border-2 transition-all ${n===e?"border-gray-400":"border-gray-200 dark:border-gray-600"}`,children:[r.jsx("div",{className:`w-full h-6 ${s} rounded mb-2`}),r.jsx("div",{className:"text-xs capitalize",children:e})]},e))})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Dark Mode"}),r.jsx("button",{onClick:t.toggleDarkMode,className:`w-12 h-6 rounded-full transition-all relative ${s?o[n]:"bg-gray-300"}`,children:r.jsx("div",{className:`w-5 h-5 bg-white rounded-full absolute top-0.5 transition-transform ${s?"translate-x-6":"translate-x-0.5"}`})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Show Balance"}),r.jsx("button",{onClick:t.toggleBalanceVisibility,className:`w-12 h-6 rounded-full transition-all relative ${a?o[n]:"bg-gray-300"}`,children:r.jsx("div",{className:`w-5 h-5 bg-white rounded-full absolute top-0.5 transition-transform ${a?"translate-x-6":"translate-x-0.5"}`})})]})]})]}),(0,r.jsxs)("div",{className:`p-6 rounded-xl ${s?"bg-gray-800":"bg-white"} border border-gray-200 dark:border-gray-700 shadow-sm`,children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Network Configuration"}),r.jsx("div",{className:"space-y-4",children:Object.entries({ethereum:{name:"Ethereum",rpc:"Mainnet",color:"bg-blue-500",gasPrice:"23 gwei"},polygon:{name:"Polygon",rpc:"Mainnet",color:"bg-purple-500",gasPrice:"32 gwei"},arbitrum:{name:"Arbitrum",rpc:"One",color:"bg-blue-600",gasPrice:"0.1 gwei"},optimism:{name:"Optimism",rpc:"Mainnet",color:"bg-red-500",gasPrice:"0.001 gwei"}}).map(([e,t])=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 dark:border-gray-600 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:`w-4 h-4 ${t.color} rounded-full`}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium",children:t.name}),r.jsx("div",{className:"text-sm text-gray-500",children:t.rpc})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("div",{className:"text-sm",children:t.gasPrice}),r.jsx("div",{className:"text-xs text-gray-500",children:"Gas Price"})]})]},e))})]})]})]})}},36619:(e,t,s)=>{"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0});var i=r(s(76162)),n=r(s(32615)),a=r(s(17360)),o=r(s(63961)),l=r(s(35240)),c=r(s(71568));let h=i.Readable,u=Symbol("buffer"),d=Symbol("type");class f{constructor(){this[d]="";let e=arguments[0],t=arguments[1],s=[];if(e){let t=Number(e.length);for(let r=0;r<t;r++){let t;let i=e[r];i instanceof Buffer?t=i:t=ArrayBuffer.isView(i)?Buffer.from(i.buffer,i.byteOffset,i.byteLength):i instanceof ArrayBuffer?Buffer.from(i):i instanceof f?i[u]:Buffer.from("string"==typeof i?i:String(i)),t.length,s.push(t)}}this[u]=Buffer.concat(s);let r=t&&void 0!==t.type&&String(t.type).toLowerCase();r&&!/[^\u0020-\u007E]/.test(r)&&(this[d]=r)}get size(){return this[u].length}get type(){return this[d]}text(){return Promise.resolve(this[u].toString())}arrayBuffer(){let e=this[u];return Promise.resolve(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}stream(){let e=new h;return e._read=function(){},e.push(this[u]),e.push(null),e}toString(){return"[object Blob]"}slice(){let e;let t=this.size,s=arguments[0],r=arguments[1];e=void 0===s?0:s<0?Math.max(t+s,0):Math.min(s,t);let i=Math.max((void 0===r?t:r<0?Math.max(t+r,0):Math.min(r,t))-e,0),n=this[u].slice(e,e+i),a=new f([],{type:arguments[2]});return a[u]=n,a}}function p(e,t,s){Error.call(this,e),this.message=e,this.type=t,s&&(this.code=this.errno=s.code),Error.captureStackTrace(this,this.constructor)}Object.defineProperties(f.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(f.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),p.prototype=Object.create(Error.prototype),p.prototype.constructor=p,p.prototype.name="FetchError";let g=Symbol("Body internals"),m=i.PassThrough;function y(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=s.size,n=s.timeout;null==e?e=null:v(e)?e=Buffer.from(e.toString()):_(e)||Buffer.isBuffer(e)||("[object ArrayBuffer]"===Object.prototype.toString.call(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof i||(e=Buffer.from(String(e)))),this[g]={body:e,disturbed:!1,error:null},this.size=void 0===r?0:r,this.timeout=void 0===n?0:n,e instanceof i&&e.on("error",function(e){let s="AbortError"===e.name?e:new p(`Invalid response body while trying to fetch ${t.url}: ${e.message}`,"system",e);t[g].error=s})}function b(){var e=this;if(this[g].disturbed)return y.Promise.reject(TypeError(`body used already for: ${this.url}`));if(this[g].disturbed=!0,this[g].error)return y.Promise.reject(this[g].error);let t=this.body;if(null===t)return y.Promise.resolve(Buffer.alloc(0));if(_(t)&&(t=t.stream()),Buffer.isBuffer(t))return y.Promise.resolve(t);if(!(t instanceof i))return y.Promise.resolve(Buffer.alloc(0));let s=[],r=0,n=!1;return new y.Promise(function(i,a){let o;e.timeout&&(o=setTimeout(function(){n=!0,a(new p(`Response timeout while trying to fetch ${e.url} (over ${e.timeout}ms)`,"body-timeout"))},e.timeout)),t.on("error",function(t){"AbortError"===t.name?(n=!0,a(t)):a(new p(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t))}),t.on("data",function(t){if(!n&&null!==t){if(e.size&&r+t.length>e.size){n=!0,a(new p(`content size at ${e.url} over limit: ${e.size}`,"max-size"));return}r+=t.length,s.push(t)}}),t.on("end",function(){if(!n){clearTimeout(o);try{i(Buffer.concat(s,r))}catch(t){a(new p(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t))}}})})}function v(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function _(e){return"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}function w(e){let t,s;let r=e.body;if(e.bodyUsed)throw Error("cannot clone body after it is used");return r instanceof i&&"function"!=typeof r.getBoundary&&(t=new m,s=new m,r.pipe(t),r.pipe(s),e[g].body=t,r=s),r}function x(e){if(null===e)return null;if("string"==typeof e)return"text/plain;charset=UTF-8";if(v(e))return"application/x-www-form-urlencoded;charset=UTF-8";if(_(e))return e.type||null;if(Buffer.isBuffer(e))return null;if("[object ArrayBuffer]"===Object.prototype.toString.call(e))return null;if(ArrayBuffer.isView(e))return null;else if("function"==typeof e.getBoundary)return`multipart/form-data;boundary=${e.getBoundary()}`;else if(e instanceof i)return null;else return"text/plain;charset=UTF-8"}function k(e){let t=e.body;return null===t?0:_(t)?t.size:Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}y.prototype={get body(){return this[g].body},get bodyUsed(){return this[g].disturbed},arrayBuffer(){return b.call(this).then(function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)})},blob(){let e=this.headers&&this.headers.get("content-type")||"";return b.call(this).then(function(t){return Object.assign(new f([],{type:e.toLowerCase()}),{[u]:t})})},json(){var e=this;return b.call(this).then(function(t){try{return JSON.parse(t.toString())}catch(t){return y.Promise.reject(new p(`invalid json response body at ${e.url} reason: ${t.message}`,"invalid-json"))}})},text(){return b.call(this).then(function(e){return e.toString()})},buffer(){return b.call(this)},textConverted(){var e=this;return b.call(this).then(function(t){return function(e,t){throw Error("The package `encoding` must be installed to use the textConverted() function")}(0,e.headers)})}},Object.defineProperties(y.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),y.mixIn=function(e){for(let t of Object.getOwnPropertyNames(y.prototype))if(!(t in e)){let s=Object.getOwnPropertyDescriptor(y.prototype,t);Object.defineProperty(e,t,s)}},y.Promise=global.Promise;let j=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,S=/[^\t\x20-\x7e\x80-\xff]/;function E(e){if(e=`${e}`,j.test(e)||""===e)throw TypeError(`${e} is not a legal HTTP header name`)}function T(e){if(e=`${e}`,S.test(e))throw TypeError(`${e} is not a legal HTTP header value`)}function N(e,t){for(let s in t=t.toLowerCase(),e)if(s.toLowerCase()===t)return s}let O=Symbol("map");class P{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[O]=Object.create(null),e instanceof P){let t=e.raw();for(let e of Object.keys(t))for(let s of t[e])this.append(e,s);return}if(null==e);else if("object"==typeof e){let t=e[Symbol.iterator];if(null!=t){if("function"!=typeof t)throw TypeError("Header pairs must be iterable");let s=[];for(let t of e){if("object"!=typeof t||"function"!=typeof t[Symbol.iterator])throw TypeError("Each header pair must be iterable");s.push(Array.from(t))}for(let e of s){if(2!==e.length)throw TypeError("Each header pair must be a name/value tuple");this.append(e[0],e[1])}}else for(let t of Object.keys(e)){let s=e[t];this.append(t,s)}}else throw TypeError("Provided initializer must be an object")}get(e){E(e=`${e}`);let t=N(this[O],e);return void 0===t?null:this[O][t].join(", ")}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,s=C(this),r=0;for(;r<s.length;){var i=s[r];let n=i[0],a=i[1];e.call(t,a,n,this),s=C(this),r++}}set(e,t){e=`${e}`,t=`${t}`,E(e),T(t);let s=N(this[O],e);this[O][void 0!==s?s:e]=[t]}append(e,t){e=`${e}`,t=`${t}`,E(e),T(t);let s=N(this[O],e);void 0!==s?this[O][s].push(t):this[O][e]=[t]}has(e){return E(e=`${e}`),void 0!==N(this[O],e)}delete(e){E(e=`${e}`);let t=N(this[O],e);void 0!==t&&delete this[O][t]}raw(){return this[O]}keys(){return $(this,"key")}values(){return $(this,"value")}[Symbol.iterator](){return $(this,"key+value")}}function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value";return Object.keys(e[O]).sort().map("key"===t?function(e){return e.toLowerCase()}:"value"===t?function(t){return e[O][t].join(", ")}:function(t){return[t.toLowerCase(),e[O][t].join(", ")]})}P.prototype.entries=P.prototype[Symbol.iterator],Object.defineProperty(P.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(P.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});let A=Symbol("internal");function $(e,t){let s=Object.create(I);return s[A]={target:e,kind:t,index:0},s}let I=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==I)throw TypeError("Value of `this` is not a HeadersIterator");var e=this[A];let t=e.target,s=e.kind,r=e.index,i=C(t,s);return r>=i.length?{value:void 0,done:!0}:(this[A].index=r+1,{value:i[r],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(I,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});let R=Symbol("Response internals"),L=n.STATUS_CODES;class U{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y.call(this,e,t);let s=t.status||200,r=new P(t.headers);if(null!=e&&!r.has("Content-Type")){let t=x(e);t&&r.append("Content-Type",t)}this[R]={url:t.url,status:s,statusText:t.statusText||L[s],headers:r,counter:t.counter}}get url(){return this[R].url||""}get status(){return this[R].status}get ok(){return this[R].status>=200&&this[R].status<300}get redirected(){return this[R].counter>0}get statusText(){return this[R].statusText}get headers(){return this[R].headers}clone(){return new U(w(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}y.mixIn(U.prototype),Object.defineProperties(U.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(U.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});let B=Symbol("Request internals"),D=a.URL||o.URL,M=a.parse,q=a.format;function F(e){return/^[a-zA-Z][a-zA-Z\d+\-.]*:/.exec(e)&&(e=new D(e).toString()),M(e)}let W="destroy"in i.Readable.prototype;function z(e){return"object"==typeof e&&"object"==typeof e[B]}class G{constructor(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};z(e)?t=F(e.url):(t=e&&e.href?F(e.href):F(`${e}`),e={});let r=s.method||e.method||"GET";if(r=r.toUpperCase(),(null!=s.body||z(e)&&null!==e.body)&&("GET"===r||"HEAD"===r))throw TypeError("Request with GET/HEAD method cannot have body");let i=null!=s.body?s.body:z(e)&&null!==e.body?w(e):null;y.call(this,i,{timeout:s.timeout||e.timeout||0,size:s.size||e.size||0});let n=new P(s.headers||e.headers||{});if(null!=i&&!n.has("Content-Type")){let e=x(i);e&&n.append("Content-Type",e)}let a=z(e)?e.signal:null;if("signal"in s&&(a=s.signal),null!=a&&!function(e){let t=e&&"object"==typeof e&&Object.getPrototypeOf(e);return!!(t&&"AbortSignal"===t.constructor.name)}(a))throw TypeError("Expected signal to be an instanceof AbortSignal");this[B]={method:r,redirect:s.redirect||e.redirect||"follow",headers:n,parsedURL:t,signal:a},this.follow=void 0!==s.follow?s.follow:void 0!==e.follow?e.follow:20,this.compress=void 0!==s.compress?s.compress:void 0===e.compress||e.compress,this.counter=s.counter||e.counter||0,this.agent=s.agent||e.agent}get method(){return this[B].method}get url(){return q(this[B].parsedURL)}get headers(){return this[B].headers}get redirect(){return this[B].redirect}get signal(){return this[B].signal}clone(){return new G(this)}}function H(e){Error.call(this,e),this.type="aborted",this.message=e,Error.captureStackTrace(this,this.constructor)}y.mixIn(G.prototype),Object.defineProperty(G.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(G.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),H.prototype=Object.create(Error.prototype),H.prototype.constructor=H,H.prototype.name="AbortError";let V=a.URL||o.URL,K=i.PassThrough,J=function(e,t){let s=new V(t).hostname,r=new V(e).hostname;return s===r||"."===s[s.length-r.length-1]&&s.endsWith(r)};function Z(e,t){if(!Z.Promise)throw Error("native promise missing, set fetch.Promise to your favorite alternative");return y.Promise=Z.Promise,new Z.Promise(function(s,r){var a;let o,h;let u=new G(e,t),d=function(e){let t=e[B].parsedURL,s=new P(e[B].headers);if(s.has("Accept")||s.set("Accept","*/*"),!t.protocol||!t.hostname)throw TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw TypeError("Only HTTP(S) protocols are supported");if(e.signal&&e.body instanceof i.Readable&&!W)throw Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let r=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(r="0"),null!=e.body){let t=k(e);"number"==typeof t&&(r=String(t))}r&&s.set("Content-Length",r),s.has("User-Agent")||s.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&!s.has("Accept-Encoding")&&s.set("Accept-Encoding","gzip,deflate");let n=e.agent;return"function"==typeof n&&(n=n(t)),s.has("Connection")||n||s.set("Connection","close"),Object.assign({},t,{method:e.method,headers:function(e){let t=Object.assign({__proto__:null},e[O]),s=N(e[O],"Host");return void 0!==s&&(t[s]=t[s][0]),t}(s),agent:n})}(u),f=("https:"===d.protocol?l:n).request,g=u.signal,m=null,y=function(){let e=new H("The user aborted a request.");r(e),u.body&&u.body instanceof i.Readable&&Y(u.body,e),m&&m.body&&m.body.emit("error",e)};if(g&&g.aborted){y();return}let b=function(){y(),w()},v=f(d);function w(){v.abort(),g&&g.removeEventListener("abort",b),clearTimeout(o)}g&&g.addEventListener("abort",b),u.timeout&&v.once("socket",function(e){o=setTimeout(function(){r(new p(`network timeout at: ${u.url}`,"request-timeout")),w()},u.timeout)}),v.on("error",function(e){r(new p(`request to ${u.url} failed, reason: ${e.message}`,"system",e)),m&&m.body&&Y(m.body,e),w()}),a=function(e){(!g||!g.aborted)&&m&&m.body&&Y(m.body,e)},v.on("socket",function(e){h=e}),v.on("response",function(e){let t=e.headers;"chunked"!==t["transfer-encoding"]||t["content-length"]||e.once("close",function(e){if(h&&h.listenerCount("data")>0&&!e){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",a(e)}})}),14>parseInt(process.version.substring(1))&&v.on("socket",function(e){e.addListener("close",function(t){let s=e.listenerCount("data")>0;if(m&&s&&!t&&!(g&&g.aborted)){let e=Error("Premature close");e.code="ERR_STREAM_PREMATURE_CLOSE",m.body.emit("error",e)}})}),v.on("response",function(e){clearTimeout(o);let t=function(e){let t=new P;for(let s of Object.keys(e))if(!j.test(s)){if(Array.isArray(e[s]))for(let r of e[s])S.test(r)||(void 0===t[O][s]?t[O][s]=[r]:t[O][s].push(r));else S.test(e[s])||(t[O][s]=[e[s]])}return t}(e.headers);if(Z.isRedirect(e.statusCode)){let n=t.get("Location"),a=null;try{a=null===n?null:new V(n,u.url).toString()}catch(e){if("manual"!==u.redirect){r(new p(`uri requested responds with an invalid redirect URL: ${n}`,"invalid-redirect")),w();return}}switch(u.redirect){case"error":r(new p(`uri requested responds with a redirect, redirect mode is set to error: ${u.url}`,"no-redirect")),w();return;case"manual":if(null!==a)try{t.set("Location",a)}catch(e){r(e)}break;case"follow":var i;if(null===a)break;if(u.counter>=u.follow){r(new p(`maximum redirect reached at: ${u.url}`,"max-redirect")),w();return}let o={headers:new P(u.headers),follow:u.follow,counter:u.counter+1,agent:u.agent,compress:u.compress,method:u.method,body:u.body,signal:u.signal,timeout:u.timeout,size:u.size};if(!J(u.url,a)||(i=u.url,new V(a).protocol!==new V(i).protocol))for(let e of["authorization","www-authenticate","cookie","cookie2"])o.headers.delete(e);if(303!==e.statusCode&&u.body&&null===k(u)){r(new p("Cannot follow redirect with body being a readable stream","unsupported-redirect")),w();return}(303===e.statusCode||(301===e.statusCode||302===e.statusCode)&&"POST"===u.method)&&(o.method="GET",o.body=void 0,o.headers.delete("content-length")),s(Z(new G(a,o))),w();return}}e.once("end",function(){g&&g.removeEventListener("abort",b)});let n=e.pipe(new K),a={url:u.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:u.size,timeout:u.timeout,counter:u.counter},l=t.get("Content-Encoding");if(!u.compress||"HEAD"===u.method||null===l||204===e.statusCode||304===e.statusCode){s(m=new U(n,a));return}let h={flush:c.Z_SYNC_FLUSH,finishFlush:c.Z_SYNC_FLUSH};if("gzip"==l||"x-gzip"==l){s(m=new U(n=n.pipe(c.createGunzip(h)),a));return}if("deflate"==l||"x-deflate"==l){let t=e.pipe(new K);t.once("data",function(e){s(m=new U(n=(15&e[0])==8?n.pipe(c.createInflate()):n.pipe(c.createInflateRaw()),a))}),t.on("end",function(){m||s(m=new U(n,a))});return}if("br"==l&&"function"==typeof c.createBrotliDecompress){s(m=new U(n=n.pipe(c.createBrotliDecompress()),a));return}s(m=new U(n,a))}),function(e,t){let s=t.body;null===s?e.end():_(s)?s.stream().pipe(e):Buffer.isBuffer(s)?(e.write(s),e.end()):s.pipe(e)}(v,u)})}function Y(e,t){e.destroy?e.destroy(t):(e.emit("error",t),e.end())}Z.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},Z.Promise=global.Promise,e.exports=t=Z,Object.defineProperty(t,"__esModule",{value:!0}),t.default=t,t.Headers=P,t.Request=G,t.Response=U,t.FetchError=p},59334:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=r(s(36619)),n=r(s(20148));class a{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=i.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,s,r;let i=null,a=null,o=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){let t=await e.text();""===t||(a="text/csv"===this.headers.Accept?t:this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}let r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),n=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");r&&n&&n.length>1&&(o=parseInt(n[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(a)&&(a.length>1?(i={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,o=null,l=406,c="Not Acceptable"):a=1===a.length?a[0]:null)}else{let t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(a=[],i=null,l=200,c="OK")}catch(s){404===e.status&&""===t?(l=204,c="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(r=null==i?void 0:i.details)||void 0===r?void 0:r.includes("0 rows"))&&(i=null,l=200,c="OK"),i&&this.shouldThrowOnError)throw new n.default(i)}return{error:i,data:a,count:o,status:l,statusText:c}});return this.shouldThrowOnError||(s=s.catch(e=>{var t,s,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}}t.default=a},83558:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=r(s(9709)),n=r(s(11074)),a=s(29107);class o{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},a.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=r}from(e){let t=new URL(`${this.url}/${e}`);return new i.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new o(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:i}={}){let a,o;let l=new URL(`${this.url}/rpc/${e}`);s||r?(a=s?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(a="POST",o=t);let c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new n.default({method:a,url:l,headers:c,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}}t.default=o},20148:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=s},11074:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=r(s(28115));class n extends i.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let s=Array.from(new Set(t)).map(e=>"string"==typeof e&&RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let i="";"plain"===r?i="pl":"phrase"===r?i="ph":"websearch"===r&&(i="w");let n=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${n}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){let r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}}t.default=n},9709:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=r(s(11074));class n{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=t,this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){let r=!1,n=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!r?"":('"'===e&&(r=!r),e)).join("");return this.url.searchParams.set("select",n),s&&(this.headers.Prefer=`count=${s}`),new i.default({method:t?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){let r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),s||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:n=!0}={}){let a=[`resolution=${s?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),n||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){let s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new i.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new i.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}t.default=n},28115:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=r(s(59334));class n extends i.default{select(e){let t=!1,s=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:i=r}={}){let n=i?`${i}.order`:"order",a=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){let r=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){let i=void 0===r?"offset":`${r}.offset`,n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(n,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:i=!1,format:n="text"}={}){var a;let o=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=null!==(a=this.headers.Accept)&&void 0!==a?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${n}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=n},29107:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;let r=s(87807);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`}},16388:function(e,t,s){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;let i=r(s(83558));t.PostgrestClient=i.default;let n=r(s(9709));t.PostgrestQueryBuilder=n.default;let a=r(s(11074));t.PostgrestFilterBuilder=a.default;let o=r(s(28115));t.PostgrestTransformBuilder=o.default;let l=r(s(59334));t.PostgrestBuilder=l.default;let c=r(s(20148));t.PostgrestError=c.default,t.default={PostgrestClient:i.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default}},87807:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},73954:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(47668).Z)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},87610:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(47668).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},64405:(e,t,s)=>{"use strict";let{EMPTY_BUFFER:r}=s(90421),i=Buffer[Symbol.species];function n(e,t,s,r,i){for(let n=0;n<i;n++)s[r+n]=e[n]^t[3&n]}function a(e,t){for(let s=0;s<e.length;s++)e[s]^=t[3&s]}if(e.exports={concat:function(e,t){if(0===e.length)return r;if(1===e.length)return e[0];let s=Buffer.allocUnsafe(t),n=0;for(let t=0;t<e.length;t++){let r=e[t];s.set(r,n),n+=r.length}return n<t?new i(s.buffer,s.byteOffset,n):s},mask:n,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){let s;return(e.readOnly=!0,Buffer.isBuffer(t))?t:(t instanceof ArrayBuffer?s=new i(t):ArrayBuffer.isView(t)?s=new i(t.buffer,t.byteOffset,t.byteLength):(s=Buffer.from(t),e.readOnly=!1),s)},unmask:a},!process.env.WS_NO_BUFFER_UTIL)try{let t=s(91688);e.exports.mask=function(e,s,r,i,a){a<48?n(e,s,r,i,a):t.mask(e,s,r,i,a)},e.exports.unmask=function(e,s){e.length<32?a(e,s):t.unmask(e,s)}}catch(e){}},90421:e=>{"use strict";let t=["nodebuffer","arraybuffer","fragments"],s="undefined"!=typeof Blob;s&&t.push("blob"),e.exports={BINARY_TYPES:t,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:s,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},16750:(e,t,s)=>{"use strict";let{kForOnEventAttribute:r,kListener:i}=s(90421),n=Symbol("kCode"),a=Symbol("kData"),o=Symbol("kError"),l=Symbol("kMessage"),c=Symbol("kReason"),h=Symbol("kTarget"),u=Symbol("kType"),d=Symbol("kWasClean");class f{constructor(e){this[h]=null,this[u]=e}get target(){return this[h]}get type(){return this[u]}}Object.defineProperty(f.prototype,"target",{enumerable:!0}),Object.defineProperty(f.prototype,"type",{enumerable:!0});class p extends f{constructor(e,t={}){super(e),this[n]=void 0===t.code?0:t.code,this[c]=void 0===t.reason?"":t.reason,this[d]=void 0!==t.wasClean&&t.wasClean}get code(){return this[n]}get reason(){return this[c]}get wasClean(){return this[d]}}Object.defineProperty(p.prototype,"code",{enumerable:!0}),Object.defineProperty(p.prototype,"reason",{enumerable:!0}),Object.defineProperty(p.prototype,"wasClean",{enumerable:!0});class g extends f{constructor(e,t={}){super(e),this[o]=void 0===t.error?null:t.error,this[l]=void 0===t.message?"":t.message}get error(){return this[o]}get message(){return this[l]}}Object.defineProperty(g.prototype,"error",{enumerable:!0}),Object.defineProperty(g.prototype,"message",{enumerable:!0});class m extends f{constructor(e,t={}){super(e),this[a]=void 0===t.data?null:t.data}get data(){return this[a]}}function y(e,t,s){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,s):e.call(t,s)}Object.defineProperty(m.prototype,"data",{enumerable:!0}),e.exports={CloseEvent:p,ErrorEvent:g,Event:f,EventTarget:{addEventListener(e,t,s={}){let n;for(let n of this.listeners(e))if(!s[r]&&n[i]===t&&!n[r])return;if("message"===e)n=function(e,s){let r=new m("message",{data:s?e:e.toString()});r[h]=this,y(t,this,r)};else if("close"===e)n=function(e,s){let r=new p("close",{code:e,reason:s.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});r[h]=this,y(t,this,r)};else if("error"===e)n=function(e){let s=new g("error",{error:e,message:e.message});s[h]=this,y(t,this,s)};else{if("open"!==e)return;n=function(){let e=new f("open");e[h]=this,y(t,this,e)}}n[r]=!!s[r],n[i]=t,s.once?this.once(e,n):this.on(e,n)},removeEventListener(e,t){for(let s of this.listeners(e))if(s[i]===t&&!s[r]){this.removeListener(e,s);break}}},MessageEvent:m}},61587:(e,t,s)=>{"use strict";let{tokenChars:r}=s(56393);function i(e,t,s){void 0===e[t]?e[t]=[s]:e[t].push(s)}e.exports={format:function(e){return Object.keys(e).map(t=>{let s=e[t];return Array.isArray(s)||(s=[s]),s.map(e=>[t].concat(Object.keys(e).map(t=>{let s=e[t];return Array.isArray(s)||(s=[s]),s.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(e){let t,s;let n=Object.create(null),a=Object.create(null),o=!1,l=!1,c=!1,h=-1,u=-1,d=-1,f=0;for(;f<e.length;f++)if(u=e.charCodeAt(f),void 0===t){if(-1===d&&1===r[u])-1===h&&(h=f);else if(0!==f&&(32===u||9===u))-1===d&&-1!==h&&(d=f);else if(59===u||44===u){if(-1===h)throw SyntaxError(`Unexpected character at index ${f}`);-1===d&&(d=f);let s=e.slice(h,d);44===u?(i(n,s,a),a=Object.create(null)):t=s,h=d=-1}else throw SyntaxError(`Unexpected character at index ${f}`)}else if(void 0===s){if(-1===d&&1===r[u])-1===h&&(h=f);else if(32===u||9===u)-1===d&&-1!==h&&(d=f);else if(59===u||44===u){if(-1===h)throw SyntaxError(`Unexpected character at index ${f}`);-1===d&&(d=f),i(a,e.slice(h,d),!0),44===u&&(i(n,t,a),a=Object.create(null),t=void 0),h=d=-1}else if(61===u&&-1!==h&&-1===d)s=e.slice(h,f),h=d=-1;else throw SyntaxError(`Unexpected character at index ${f}`)}else if(l){if(1!==r[u])throw SyntaxError(`Unexpected character at index ${f}`);-1===h?h=f:o||(o=!0),l=!1}else if(c){if(1===r[u])-1===h&&(h=f);else if(34===u&&-1!==h)c=!1,d=f;else if(92===u)l=!0;else throw SyntaxError(`Unexpected character at index ${f}`)}else if(34===u&&61===e.charCodeAt(f-1))c=!0;else if(-1===d&&1===r[u])-1===h&&(h=f);else if(-1!==h&&(32===u||9===u))-1===d&&(d=f);else if(59===u||44===u){if(-1===h)throw SyntaxError(`Unexpected character at index ${f}`);-1===d&&(d=f);let r=e.slice(h,d);o&&(r=r.replace(/\\/g,""),o=!1),i(a,s,r),44===u&&(i(n,t,a),a=Object.create(null),t=void 0),s=void 0,h=d=-1}else throw SyntaxError(`Unexpected character at index ${f}`);if(-1===h||c||32===u||9===u)throw SyntaxError("Unexpected end of input");-1===d&&(d=f);let p=e.slice(h,d);return void 0===t?i(n,p,a):(void 0===s?i(a,p,!0):o?i(a,s,p.replace(/\\/g,"")):i(a,s,p),i(n,t,a)),n}}},92031:e=>{"use strict";let t=Symbol("kDone"),s=Symbol("kRun");class r{constructor(e){this[t]=()=>{this.pending--,this[s]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[s]()}[s](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[t])}}}e.exports=r},63844:(e,t,s)=>{"use strict";let r;let i=s(71568),n=s(64405),a=s(92031),{kStatusCode:o}=s(90421),l=Buffer[Symbol.species],c=Buffer.from([0,0,255,255]),h=Symbol("permessage-deflate"),u=Symbol("total-length"),d=Symbol("callback"),f=Symbol("buffers"),p=Symbol("error");class g{constructor(e,t,s){this._maxPayload=0|s,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,r||(r=new a(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[d];this._deflate.close(),this._deflate=null,e&&e(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,s=e.find(e=>(!1!==t.serverNoContextTakeover||!e.server_no_context_takeover)&&(!e.server_max_window_bits||!1!==t.serverMaxWindowBits&&("number"!=typeof t.serverMaxWindowBits||!(t.serverMaxWindowBits>e.server_max_window_bits)))&&("number"!=typeof t.clientMaxWindowBits||!!e.client_max_window_bits));if(!s)throw Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(s.server_no_context_takeover=!0),t.clientNoContextTakeover&&(s.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(s.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?s.client_max_window_bits=t.clientMaxWindowBits:(!0===s.client_max_window_bits||!1===t.clientMaxWindowBits)&&delete s.client_max_window_bits,s}acceptAsClient(e){let t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{let s=e[t];if(s.length>1)throw Error(`Parameter "${t}" must have only a single value`);if(s=s[0],"client_max_window_bits"===t){if(!0!==s){let e=+s;if(!Number.isInteger(e)||e<8||e>15)throw TypeError(`Invalid value for parameter "${t}": ${s}`);s=e}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${t}": ${s}`)}else if("server_max_window_bits"===t){let e=+s;if(!Number.isInteger(e)||e<8||e>15)throw TypeError(`Invalid value for parameter "${t}": ${s}`);s=e}else if("client_no_context_takeover"===t||"server_no_context_takeover"===t){if(!0!==s)throw TypeError(`Invalid value for parameter "${t}": ${s}`)}else throw Error(`Unknown parameter "${t}"`);e[t]=s})}),e}decompress(e,t,s){r.add(r=>{this._decompress(e,t,(e,t)=>{r(),s(e,t)})})}compress(e,t,s){r.add(r=>{this._compress(e,t,(e,t)=>{r(),s(e,t)})})}_decompress(e,t,s){let r=this._isServer?"client":"server";if(!this._inflate){let e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[h]=this,this._inflate[u]=0,this._inflate[f]=[],this._inflate.on("error",b),this._inflate.on("data",y)}this._inflate[d]=s,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush(()=>{let e=this._inflate[p];if(e){this._inflate.close(),this._inflate=null,s(e);return}let i=n.concat(this._inflate[f],this._inflate[u]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[u]=0,this._inflate[f]=[],t&&this.params[`${r}_no_context_takeover`]&&this._inflate.reset()),s(null,i)})}_compress(e,t,s){let r=this._isServer?"server":"client";if(!this._deflate){let e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[u]=0,this._deflate[f]=[],this._deflate.on("data",m)}this._deflate[d]=s,this._deflate.write(e),this._deflate.flush(i.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let e=n.concat(this._deflate[f],this._deflate[u]);t&&(e=new l(e.buffer,e.byteOffset,e.length-4)),this._deflate[d]=null,this._deflate[u]=0,this._deflate[f]=[],t&&this.params[`${r}_no_context_takeover`]&&this._deflate.reset(),s(null,e)})}}function m(e){this[f].push(e),this[u]+=e.length}function y(e){if(this[u]+=e.length,this[h]._maxPayload<1||this[u]<=this[h]._maxPayload){this[f].push(e);return}this[p]=RangeError("Max payload size exceeded"),this[p].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[p][o]=1009,this.removeListener("data",y),this.reset()}function b(e){if(this[h]._inflate=null,this[p]){this[d](this[p]);return}e[o]=1007,this[d](e)}e.exports=g},64462:(e,t,s)=>{"use strict";let{Writable:r}=s(76162),i=s(63844),{BINARY_TYPES:n,EMPTY_BUFFER:a,kStatusCode:o,kWebSocket:l}=s(90421),{concat:c,toArrayBuffer:h,unmask:u}=s(64405),{isValidStatusCode:d,isValidUTF8:f}=s(56393),p=Buffer[Symbol.species];class g extends r{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||n[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[l]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,s){if(8===this._opcode&&0==this._state)return s();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(s)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let t=this._buffers[0];return this._buffers[0]=new p(t.buffer,t.byteOffset+e,t.length-e),new p(t.buffer,t.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let s=this._buffers[0],r=t.length-e;e>=s.length?t.set(this._buffers.shift(),r):(t.set(new Uint8Array(s.buffer,s.byteOffset,e),r),this._buffers[0]=new p(s.buffer,s.byteOffset+e,s.length-e)),e-=s.length}while(e>0);return t}startLoop(e){this._loop=!0;do switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((48&t[0])!=0){e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));return}let s=(64&t[0])==64;if(s&&!this._extensions[i.extensionName]){e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));return}if(this._fin=(128&t[0])==128,this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(s){e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));return}if(!this._fragmented){e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));return}this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented){e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));return}this._compressed=s}else if(this._opcode>7&&this._opcode<11){if(!this._fin){e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));return}if(s){e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));return}if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength){e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"));return}}else{e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));return}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&t[1])==128,this._isServer){if(!this._masked){e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"));return}}else if(this._masked){e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));return}126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),s=t.readUInt32BE(0);if(s>2097151){e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH"));return}this._payloadLength=4294967296*s+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));return}this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(e){let t=a;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&u(t,this._mask)}if(this._opcode>7){this.controlMessage(t,e);return}if(this._compressed){this._state=5,this.decompress(t,e);return}t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}decompress(e,t){this._extensions[i.extensionName].decompress(e,this._fin,(e,s)=>{if(e)return t(e);if(s.length){if(this._messageLength+=s.length,this._messageLength>this._maxPayload&&this._maxPayload>0){t(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));return}this._fragments.push(s)}this.dataMessage(t),0===this._state&&this.startLoop(t)})}dataMessage(e){if(!this._fin){this._state=0;return}let t=this._messageLength,s=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let r;r="nodebuffer"===this._binaryType?c(s,t):"arraybuffer"===this._binaryType?h(c(s,t)):"blob"===this._binaryType?new Blob(s):s,this._allowSynchronousEvents?(this.emit("message",r,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",r,!0),this._state=0,this.startLoop(e)}))}else{let r=c(s,t);if(!this._skipUTF8Validation&&!f(r)){e(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));return}5===this._state||this._allowSynchronousEvents?(this.emit("message",r,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",r,!1),this._state=0,this.startLoop(e)}))}}controlMessage(e,t){if(8===this._opcode){if(0===e.length)this._loop=!1,this.emit("conclude",1005,a),this.end();else{let s=e.readUInt16BE(0);if(!d(s)){t(this.createError(RangeError,`invalid status code ${s}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));return}let r=new p(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!f(r)){t(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));return}this._loop=!1,this.emit("conclude",s,r),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)}))}createError(e,t,s,r,i){this._loop=!1,this._errored=!0;let n=new e(s?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(n,this.createError),n.code=i,n[o]=r,n}}e.exports=g},85364:(e,t,s)=>{"use strict";let r;let{Duplex:i}=s(76162),{randomFillSync:n}=s(84770),a=s(63844),{EMPTY_BUFFER:o,kWebSocket:l,NOOP:c}=s(90421),{isBlob:h,isValidStatusCode:u}=s(56393),{mask:d,toBuffer:f}=s(64405),p=Symbol("kByteLength"),g=Buffer.alloc(4),m=8192;class y{constructor(e,t,s){this._extensions=t||{},s&&(this._generateMask=s,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=c,this[l]=void 0}static frame(e,t){let s,i;let a=!1,o=2,l=!1;t.mask&&(s=t.maskBuffer||g,t.generateMask?t.generateMask(s):(8192===m&&(void 0===r&&(r=Buffer.alloc(8192)),n(r,0,8192),m=0),s[0]=r[m++],s[1]=r[m++],s[2]=r[m++],s[3]=r[m++]),l=(s[0]|s[1]|s[2]|s[3])==0,o=6),"string"==typeof e?i=(!t.mask||l)&&void 0!==t[p]?t[p]:(e=Buffer.from(e)).length:(i=e.length,a=t.mask&&t.readOnly&&!l);let c=i;i>=65536?(o+=8,c=127):i>125&&(o+=2,c=126);let h=Buffer.allocUnsafe(a?i+o:o);return(h[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(h[0]|=64),h[1]=c,126===c?h.writeUInt16BE(i,2):127===c&&(h[2]=h[3]=0,h.writeUIntBE(i,4,6)),t.mask)?(h[1]|=128,h[o-4]=s[0],h[o-3]=s[1],h[o-2]=s[2],h[o-1]=s[3],l)?[h,e]:a?(d(e,s,h,o,i),[h]):(d(e,s,e,0,i),[h,e]):[h,e]}close(e,t,s,r){let i;if(void 0===e)i=o;else if("number"==typeof e&&u(e)){if(void 0!==t&&t.length){let s=Buffer.byteLength(t);if(s>123)throw RangeError("The message must not be greater than 123 bytes");(i=Buffer.allocUnsafe(2+s)).writeUInt16BE(e,0),"string"==typeof t?i.write(t,2):i.set(t,2)}else(i=Buffer.allocUnsafe(2)).writeUInt16BE(e,0)}else throw TypeError("First argument must be a valid error code number");let n={[p]:i.length,fin:!0,generateMask:this._generateMask,mask:s,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,i,!1,n,r]):this.sendFrame(y.frame(i,n),r)}ping(e,t,s){let r,i;if("string"==typeof e?(r=Buffer.byteLength(e),i=!1):h(e)?(r=e.size,i=!1):(r=(e=f(e)).length,i=f.readOnly),r>125)throw RangeError("The data size must not be greater than 125 bytes");let n={[p]:r,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};h(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,n,s]):this.getBlobData(e,!1,n,s):0!==this._state?this.enqueue([this.dispatch,e,!1,n,s]):this.sendFrame(y.frame(e,n),s)}pong(e,t,s){let r,i;if("string"==typeof e?(r=Buffer.byteLength(e),i=!1):h(e)?(r=e.size,i=!1):(r=(e=f(e)).length,i=f.readOnly),r>125)throw RangeError("The data size must not be greater than 125 bytes");let n={[p]:r,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};h(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,n,s]):this.getBlobData(e,!1,n,s):0!==this._state?this.enqueue([this.dispatch,e,!1,n,s]):this.sendFrame(y.frame(e,n),s)}send(e,t,s){let r,i;let n=this._extensions[a.extensionName],o=t.binary?2:1,l=t.compress;"string"==typeof e?(r=Buffer.byteLength(e),i=!1):h(e)?(r=e.size,i=!1):(r=(e=f(e)).length,i=f.readOnly),this._firstFragment?(this._firstFragment=!1,l&&n&&n.params[n._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(l=r>=n._threshold),this._compress=l):(l=!1,o=0),t.fin&&(this._firstFragment=!0);let c={[p]:r,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:o,readOnly:i,rsv1:l};h(e)?0!==this._state?this.enqueue([this.getBlobData,e,this._compress,c,s]):this.getBlobData(e,this._compress,c,s):0!==this._state?this.enqueue([this.dispatch,e,this._compress,c,s]):this.dispatch(e,this._compress,c,s)}getBlobData(e,t,s,r){this._bufferedBytes+=s[p],this._state=2,e.arrayBuffer().then(e=>{if(this._socket.destroyed){let e=Error("The socket was closed while the blob was being read");process.nextTick(b,this,e,r);return}this._bufferedBytes-=s[p];let i=f(e);t?this.dispatch(i,t,s,r):(this._state=0,this.sendFrame(y.frame(i,s),r),this.dequeue())}).catch(e=>{process.nextTick(v,this,e,r)})}dispatch(e,t,s,r){if(!t){this.sendFrame(y.frame(e,s),r);return}let i=this._extensions[a.extensionName];this._bufferedBytes+=s[p],this._state=1,i.compress(e,s.fin,(e,t)=>{if(this._socket.destroyed){b(this,Error("The socket was closed while data was being compressed"),r);return}this._bufferedBytes-=s[p],this._state=0,s.readOnly=!1,this.sendFrame(y.frame(t,s),r),this.dequeue()})}dequeue(){for(;0===this._state&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][p],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][p],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}function b(e,t,s){"function"==typeof s&&s(t);for(let s=0;s<e._queue.length;s++){let r=e._queue[s],i=r[r.length-1];"function"==typeof i&&i(t)}}function v(e,t,s){b(e,t,s),e.onerror(t)}e.exports=y},71767:(e,t,s)=>{"use strict";s(26086);let{Duplex:r}=s(76162);function i(e){e.emit("close")}function n(){!this.destroyed&&this._writableState.finished&&this.destroy()}function a(e){this.removeListener("error",a),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let s=!0,o=new r({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",function(t,s){let r=!s&&o._readableState.objectMode?t.toString():t;o.push(r)||e.pause()}),e.once("error",function(e){o.destroyed||(s=!1,o.destroy(e))}),e.once("close",function(){o.destroyed||o.push(null)}),o._destroy=function(t,r){if(e.readyState===e.CLOSED){r(t),process.nextTick(i,o);return}let n=!1;e.once("error",function(e){n=!0,r(e)}),e.once("close",function(){n||r(t),process.nextTick(i,o)}),s&&e.terminate()},o._final=function(t){if(e.readyState===e.CONNECTING){e.once("open",function(){o._final(t)});return}null!==e._socket&&(e._socket._writableState.finished?(t(),o._readableState.endEmitted&&o.destroy()):(e._socket.once("finish",function(){t()}),e.close()))},o._read=function(){e.isPaused&&e.resume()},o._write=function(t,s,r){if(e.readyState===e.CONNECTING){e.once("open",function(){o._write(t,s,r)});return}e.send(t,r)},o.on("end",n),o.on("error",a),o}},46593:(e,t,s)=>{"use strict";let{tokenChars:r}=s(56393);e.exports={parse:function(e){let t=new Set,s=-1,i=-1,n=0;for(;n<e.length;n++){let a=e.charCodeAt(n);if(-1===i&&1===r[a])-1===s&&(s=n);else if(0!==n&&(32===a||9===a))-1===i&&-1!==s&&(i=n);else if(44===a){if(-1===s)throw SyntaxError(`Unexpected character at index ${n}`);-1===i&&(i=n);let r=e.slice(s,i);if(t.has(r))throw SyntaxError(`The "${r}" subprotocol is duplicated`);t.add(r),s=i=-1}else throw SyntaxError(`Unexpected character at index ${n}`)}if(-1===s||-1!==i)throw SyntaxError("Unexpected end of input");let a=e.slice(s,n);if(t.has(a))throw SyntaxError(`The "${a}" subprotocol is duplicated`);return t.add(a),t}}},56393:(e,t,s)=>{"use strict";let{isUtf8:r}=s(78893),{hasBlob:i}=s(90421);function n(e){let t=e.length,s=0;for(;s<t;)if((128&e[s])==0)s++;else if((224&e[s])==192){if(s+1===t||(192&e[s+1])!=128||(254&e[s])==192)return!1;s+=2}else if((240&e[s])==224){if(s+2>=t||(192&e[s+1])!=128||(192&e[s+2])!=128||224===e[s]&&(224&e[s+1])==128||237===e[s]&&(224&e[s+1])==160)return!1;s+=3}else{if((248&e[s])!=240||s+3>=t||(192&e[s+1])!=128||(192&e[s+2])!=128||(192&e[s+3])!=128||240===e[s]&&(240&e[s+1])==128||244===e[s]&&e[s+1]>143||e[s]>244)return!1;s+=4}return!0}if(e.exports={isBlob:function(e){return i&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&("Blob"===e[Symbol.toStringTag]||"File"===e[Symbol.toStringTag])},isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:n,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},r)e.exports.isValidUTF8=function(e){return e.length<24?n(e):r(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let t=s(194);e.exports.isValidUTF8=function(e){return e.length<32?n(e):t(e)}}catch(e){}},43128:(e,t,s)=>{"use strict";let r=s(17702),i=s(32615),{Duplex:n}=s(76162),{createHash:a}=s(84770),o=s(61587),l=s(63844),c=s(46593),h=s(26086),{GUID:u,kWebSocket:d}=s(90421),f=/^[+/0-9A-Za-z]{22}==$/;class p extends r{constructor(e,t){if(super(),null==(e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:h,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=i.createServer((e,t)=>{let s=i.STATUS_CODES[426];t.writeHead(426,{"Content-Length":s.length,"Content-Type":"text/plain"}),t.end(s)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(let s of Object.keys(t))e.on(s,t[s]);return function(){for(let s of Object.keys(t))e.removeListener(s,t[s])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,s,r)=>{this.handleUpgrade(t,s,r,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state){e&&this.once("close",()=>{e(Error("The server is not running"))}),process.nextTick(g,this);return}if(e&&this.once("close",e),1!==this._state){if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(g,this);else{let e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close(()=>{g(this)})}}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,s,r){t.on("error",m);let i=e.headers["sec-websocket-key"],n=e.headers.upgrade,a=+e.headers["sec-websocket-version"];if("GET"!==e.method){b(this,e,t,405,"Invalid HTTP method");return}if(void 0===n||"websocket"!==n.toLowerCase()){b(this,e,t,400,"Invalid Upgrade header");return}if(void 0===i||!f.test(i)){b(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");return}if(13!==a&&8!==a){b(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});return}if(!this.shouldHandle(e)){y(t,400);return}let h=e.headers["sec-websocket-protocol"],u=new Set;if(void 0!==h)try{u=c.parse(h)}catch(s){b(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let d=e.headers["sec-websocket-extensions"],p={};if(this.options.perMessageDeflate&&void 0!==d){let s=new l(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let e=o.parse(d);e[l.extensionName]&&(s.accept(e[l.extensionName]),p[l.extensionName]=s)}catch(s){b(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let n={origin:e.headers[`${8===a?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(2===this.options.verifyClient.length){this.options.verifyClient(n,(n,a,o,l)=>{if(!n)return y(t,a||401,o,l);this.completeUpgrade(p,i,u,e,t,s,r)});return}if(!this.options.verifyClient(n))return y(t,401)}this.completeUpgrade(p,i,u,e,t,s,r)}completeUpgrade(e,t,s,r,i,n,c){if(!i.readable||!i.writable)return i.destroy();if(i[d])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return y(i,503);let h=a("sha1").update(t+u).digest("base64"),f=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${h}`],p=new this.options.WebSocket(null,void 0,this.options);if(s.size){let e=this.options.handleProtocols?this.options.handleProtocols(s,r):s.values().next().value;e&&(f.push(`Sec-WebSocket-Protocol: ${e}`),p._protocol=e)}if(e[l.extensionName]){let t=e[l.extensionName].params,s=o.format({[l.extensionName]:[t]});f.push(`Sec-WebSocket-Extensions: ${s}`),p._extensions=e}this.emit("headers",f,r),i.write(f.concat("\r\n").join("\r\n")),i.removeListener("error",m),p.setSocket(i,n,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(p),p.on("close",()=>{this.clients.delete(p),this._shouldEmitClose&&!this.clients.size&&process.nextTick(g,this)})),c(p,r)}}function g(e){e._state=2,e.emit("close")}function m(){this.destroy()}function y(e,t,s,r){s=s||i.STATUS_CODES[t],r={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(s),...r},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${i.STATUS_CODES[t]}\r
`+Object.keys(r).map(e=>`${e}: ${r[e]}`).join("\r\n")+"\r\n\r\n"+s)}function b(e,t,s,r,i,n){if(e.listenerCount("wsClientError")){let r=Error(i);Error.captureStackTrace(r,b),e.emit("wsClientError",r,s,t)}else y(s,r,i,n)}e.exports=p},26086:(e,t,s)=>{"use strict";let r=s(17702),i=s(35240),n=s(32615),a=s(98216),o=s(82452),{randomBytes:l,createHash:c}=s(84770),{Duplex:h,Readable:u}=s(76162),{URL:d}=s(17360),f=s(63844),p=s(64462),g=s(85364),{isBlob:m}=s(56393),{BINARY_TYPES:y,EMPTY_BUFFER:b,GUID:v,kForOnEventAttribute:_,kListener:w,kStatusCode:x,kWebSocket:k,NOOP:j}=s(90421),{EventTarget:{addEventListener:S,removeEventListener:E}}=s(16750),{format:T,parse:N}=s(61587),{toBuffer:O}=s(64405),P=Symbol("kAborted"),C=[8,13],A=["CONNECTING","OPEN","CLOSING","CLOSED"],$=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class I extends r{constructor(e,t,s){super(),this._binaryType=y[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=b,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=I.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(s=t,t=[]):t=[t]),function e(t,s,r,a){let o,h,u,p;let g={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:C[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...a,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(t._autoPong=g.autoPong,!C.includes(g.protocolVersion))throw RangeError(`Unsupported protocol version: ${g.protocolVersion} (supported versions: ${C.join(", ")})`);if(s instanceof d)o=s;else try{o=new d(s)}catch(e){throw SyntaxError(`Invalid URL: ${s}`)}"http:"===o.protocol?o.protocol="ws:":"https:"===o.protocol&&(o.protocol="wss:"),t._url=o.href;let m="wss:"===o.protocol,y="ws+unix:"===o.protocol;if("ws:"===o.protocol||m||y?y&&!o.pathname?h="The URL's pathname is empty":o.hash&&(h="The URL contains a fragment identifier"):h='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',h){let e=SyntaxError(h);if(0===t._redirects)throw e;R(t,e);return}let b=m?443:80,_=l(16).toString("base64"),w=m?i.request:n.request,x=new Set;if(g.createConnection=g.createConnection||(m?U:L),g.defaultPort=g.defaultPort||b,g.port=o.port||b,g.host=o.hostname.startsWith("[")?o.hostname.slice(1,-1):o.hostname,g.headers={...g.headers,"Sec-WebSocket-Version":g.protocolVersion,"Sec-WebSocket-Key":_,Connection:"Upgrade",Upgrade:"websocket"},g.path=o.pathname+o.search,g.timeout=g.handshakeTimeout,g.perMessageDeflate&&(u=new f(!0!==g.perMessageDeflate?g.perMessageDeflate:{},!1,g.maxPayload),g.headers["Sec-WebSocket-Extensions"]=T({[f.extensionName]:u.offer()})),r.length){for(let e of r){if("string"!=typeof e||!$.test(e)||x.has(e))throw SyntaxError("An invalid or duplicated subprotocol was specified");x.add(e)}g.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(g.origin&&(g.protocolVersion<13?g.headers["Sec-WebSocket-Origin"]=g.origin:g.headers.Origin=g.origin),(o.username||o.password)&&(g.auth=`${o.username}:${o.password}`),y){let e=g.path.split(":");g.socketPath=e[0],g.path=e[1]}if(g.followRedirects){if(0===t._redirects){t._originalIpc=y,t._originalSecure=m,t._originalHostOrSocketPath=y?g.socketPath:o.host;let e=a&&a.headers;if(a={...a,headers:{}},e)for(let[t,s]of Object.entries(e))a.headers[t.toLowerCase()]=s}else if(0===t.listenerCount("redirect")){let e=y?!!t._originalIpc&&g.socketPath===t._originalHostOrSocketPath:!t._originalIpc&&o.host===t._originalHostOrSocketPath;e&&(!t._originalSecure||m)||(delete g.headers.authorization,delete g.headers.cookie,e||delete g.headers.host,g.auth=void 0)}g.auth&&!a.headers.authorization&&(a.headers.authorization="Basic "+Buffer.from(g.auth).toString("base64")),p=t._req=w(g),t._redirects&&t.emit("redirect",t.url,p)}else p=t._req=w(g);g.timeout&&p.on("timeout",()=>{B(t,p,"Opening handshake has timed out")}),p.on("error",e=>{null===p||p[P]||(p=t._req=null,R(t,e))}),p.on("response",i=>{let n=i.headers.location,o=i.statusCode;if(n&&g.followRedirects&&o>=300&&o<400){let i;if(++t._redirects>g.maxRedirects){B(t,p,"Maximum redirects exceeded");return}p.abort();try{i=new d(n,s)}catch(e){R(t,SyntaxError(`Invalid URL: ${n}`));return}e(t,i,r,a)}else t.emit("unexpected-response",p,i)||B(t,p,`Unexpected server response: ${i.statusCode}`)}),p.on("upgrade",(e,s,r)=>{let i;if(t.emit("upgrade",e),t.readyState!==I.CONNECTING)return;p=t._req=null;let n=e.headers.upgrade;if(void 0===n||"websocket"!==n.toLowerCase()){B(t,s,"Invalid Upgrade header");return}let a=c("sha1").update(_+v).digest("base64");if(e.headers["sec-websocket-accept"]!==a){B(t,s,"Invalid Sec-WebSocket-Accept header");return}let o=e.headers["sec-websocket-protocol"];if(void 0!==o?x.size?x.has(o)||(i="Server sent an invalid subprotocol"):i="Server sent a subprotocol but none was requested":x.size&&(i="Server sent no subprotocol"),i){B(t,s,i);return}o&&(t._protocol=o);let l=e.headers["sec-websocket-extensions"];if(void 0!==l){let e;if(!u){B(t,s,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}try{e=N(l)}catch(e){B(t,s,"Invalid Sec-WebSocket-Extensions header");return}let r=Object.keys(e);if(1!==r.length||r[0]!==f.extensionName){B(t,s,"Server indicated an extension that was not requested");return}try{u.accept(e[f.extensionName])}catch(e){B(t,s,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[f.extensionName]=u}t.setSocket(s,r,{allowSynchronousEvents:g.allowSynchronousEvents,generateMask:g.generateMask,maxPayload:g.maxPayload,skipUTF8Validation:g.skipUTF8Validation})}),g.finishRequest?g.finishRequest(p,t):p.end()}(this,e,t,s)):(this._autoPong=s.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){y.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,s){let r=new p({allowSynchronousEvents:s.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation}),i=new g(e,this._extensions,s.generateMask);this._receiver=r,this._sender=i,this._socket=e,r[k]=this,i[k]=this,e[k]=this,r.on("conclude",M),r.on("drain",q),r.on("error",F),r.on("message",z),r.on("ping",G),r.on("pong",H),i.onerror=K,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",Z),e.on("data",Y),e.on("end",X),e.on("error",Q),this._readyState=I.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[f.extensionName]&&this._extensions[f.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=I.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING){B(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===I.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=I.CLOSING,this._sender.close(e,t,!this._isServer,e=>{!e&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),J(this)}}pause(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,s){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof e?(s=e,e=t=void 0):"function"==typeof t&&(s=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==I.OPEN){D(this,e,s);return}void 0===t&&(t=!this._isServer),this._sender.ping(e||b,t,s)}pong(e,t,s){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof e?(s=e,e=t=void 0):"function"==typeof t&&(s=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==I.OPEN){D(this,e,s);return}void 0===t&&(t=!this._isServer),this._sender.pong(e||b,t,s)}resume(){this.readyState!==I.CONNECTING&&this.readyState!==I.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,s){if(this.readyState===I.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(s=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==I.OPEN){D(this,e,s);return}let r={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[f.extensionName]||(r.compress=!1),this._sender.send(e||b,r,s)}terminate(){if(this.readyState!==I.CLOSED){if(this.readyState===I.CONNECTING){B(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=I.CLOSING,this._socket.destroy())}}}function R(e,t){e._readyState=I.CLOSING,e._errorEmitted=!0,e.emit("error",t),e.emitClose()}function L(e){return e.path=e.socketPath,a.connect(e)}function U(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=a.isIP(e.host)?"":e.host),o.connect(e)}function B(e,t,s){e._readyState=I.CLOSING;let r=Error(s);Error.captureStackTrace(r,B),t.setHeader?(t[P]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(R,e,r)):(t.destroy(r),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function D(e,t,s){if(t){let s=m(t)?t.size:O(t).length;e._socket?e._sender._bufferedBytes+=s:e._bufferedAmount+=s}if(s){let t=Error(`WebSocket is not open: readyState ${e.readyState} (${A[e.readyState]})`);process.nextTick(s,t)}}function M(e,t){let s=this[k];s._closeFrameReceived=!0,s._closeMessage=t,s._closeCode=e,void 0!==s._socket[k]&&(s._socket.removeListener("data",Y),process.nextTick(V,s._socket),1005===e?s.close():s.close(e,t))}function q(){let e=this[k];e.isPaused||e._socket.resume()}function F(e){let t=this[k];void 0!==t._socket[k]&&(t._socket.removeListener("data",Y),process.nextTick(V,t._socket),t.close(e[x])),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e))}function W(){this[k].emitClose()}function z(e,t){this[k].emit("message",e,t)}function G(e){let t=this[k];t._autoPong&&t.pong(e,!this._isServer,j),t.emit("ping",e)}function H(e){this[k].emit("pong",e)}function V(e){e.resume()}function K(e){let t=this[k];t.readyState===I.CLOSED||(t.readyState===I.OPEN&&(t._readyState=I.CLOSING,J(t)),this._socket.end(),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e)))}function J(e){e._closeTimer=setTimeout(e._socket.destroy.bind(e._socket),3e4)}function Z(){let e;let t=this[k];this.removeListener("close",Z),this.removeListener("data",Y),this.removeListener("end",X),t._readyState=I.CLOSING,this._readableState.endEmitted||t._closeFrameReceived||t._receiver._writableState.errorEmitted||null===(e=t._socket.read())||t._receiver.write(e),t._receiver.end(),this[k]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",W),t._receiver.on("finish",W))}function Y(e){this[k]._receiver.write(e)||this.pause()}function X(){let e=this[k];e._readyState=I.CLOSING,e._receiver.end(),this.end()}function Q(){let e=this[k];this.removeListener("error",Q),this.on("error",j),e&&(e._readyState=I.CLOSING,this.destroy())}Object.defineProperty(I,"CONNECTING",{enumerable:!0,value:A.indexOf("CONNECTING")}),Object.defineProperty(I.prototype,"CONNECTING",{enumerable:!0,value:A.indexOf("CONNECTING")}),Object.defineProperty(I,"OPEN",{enumerable:!0,value:A.indexOf("OPEN")}),Object.defineProperty(I.prototype,"OPEN",{enumerable:!0,value:A.indexOf("OPEN")}),Object.defineProperty(I,"CLOSING",{enumerable:!0,value:A.indexOf("CLOSING")}),Object.defineProperty(I.prototype,"CLOSING",{enumerable:!0,value:A.indexOf("CLOSING")}),Object.defineProperty(I,"CLOSED",{enumerable:!0,value:A.indexOf("CLOSED")}),Object.defineProperty(I.prototype,"CLOSED",{enumerable:!0,value:A.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(e=>{Object.defineProperty(I.prototype,e,{enumerable:!0})}),["open","error","close","message"].forEach(e=>{Object.defineProperty(I.prototype,`on${e}`,{enumerable:!0,get(){for(let t of this.listeners(e))if(t[_])return t[w];return null},set(t){for(let t of this.listeners(e))if(t[_]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[_]:!0})}})}),I.prototype.addEventListener=S,I.prototype.removeEventListener=E,e.exports=I},94401:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(69285).createProxy)(String.raw`C:\Users\Administrator\theatom\frontend\app\page.tsx#default`)}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[541,751,961,92,742,549,130],()=>s(43777));module.exports=r})();